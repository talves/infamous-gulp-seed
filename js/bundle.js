!function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("../core/Commands"),s=function(){function e(t){i(this,e),this._node=t,this._projectionType=e.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this._requestingUpdate=!1,this._id=t.addComponent(this),this._viewTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._viewDirty=!1,this._perspectiveDirty=!1,this.setFlat()}return r(e,[{key:"toString",value:function(){return"Camera"}},{key:"getValue",value:function(){return{component:this.toString(),projectionType:this._projectionType,focalDepth:this._focalDepth,near:this._near,far:this._far}}},{key:"setValue",value:function(e){return this.toString()===e.component?(this.set(e.projectionType,e.focalDepth,e.near,e.far),!0):!1}},{key:"set",value:function(e,t,n,i){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._projectionType=e,this._focalDepth=t,this._near=n,this._far=i}},{key:"setDepth",value:function(t){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=e.PINHOLE_PROJECTION,this._focalDepth=t,this._near=0,this._far=0,this}},{key:"setFrustum",value:function(t,n){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=e.FRUSTUM_PROJECTION,this._focalDepth=0,this._near=t,this._far=n,this}},{key:"setFlat",value:function(){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=e.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this}},{key:"onUpdate",value:function(){this._requestingUpdate=!1;var t=this._node.getLocation();if(this._node.sendDrawCommand(o.Commands.WITH).sendDrawCommand(t),this._perspectiveDirty)switch(this._perspectiveDirty=!1,this._projectionType){case e.FRUSTUM_PROJECTION:this._node.sendDrawCommand(o.Commands.FRUSTRUM_PROJECTION),this._node.sendDrawCommand(this._near),this._node.sendDrawCommand(this._far);break;case e.PINHOLE_PROJECTION:this._node.sendDrawCommand(o.Commands.PINHOLE_PROJECTION),this._node.sendDrawCommand(this._focalDepth);break;case e.ORTHOGRAPHIC_PROJECTION:this._node.sendDrawCommand(o.Commands.ORTHOGRAPHIC_PROJECTION)}this._viewDirty&&(this._viewDirty=!1,this._node.sendDrawCommand(o.Commands.CHANGE_VIEW_TRANSFORM),this._node.sendDrawCommand(this._viewTransform[0]),this._node.sendDrawCommand(this._viewTransform[1]),this._node.sendDrawCommand(this._viewTransform[2]),this._node.sendDrawCommand(this._viewTransform[3]),this._node.sendDrawCommand(this._viewTransform[4]),this._node.sendDrawCommand(this._viewTransform[5]),this._node.sendDrawCommand(this._viewTransform[6]),this._node.sendDrawCommand(this._viewTransform[7]),this._node.sendDrawCommand(this._viewTransform[8]),this._node.sendDrawCommand(this._viewTransform[9]),this._node.sendDrawCommand(this._viewTransform[10]),this._node.sendDrawCommand(this._viewTransform[11]),this._node.sendDrawCommand(this._viewTransform[12]),this._node.sendDrawCommand(this._viewTransform[13]),this._node.sendDrawCommand(this._viewTransform[14]),this._node.sendDrawCommand(this._viewTransform[15]))}},{key:"onTransformChange",value:function(e){var t=e;this._viewDirty=!0,this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],u=t[6],h=t[7],l=t[8],c=t[9],f=t[10],d=t[11],p=t[12],m=t[13],_=t[14],g=t[15],v=n*a-i*s,y=n*u-r*s,b=n*h-o*s,E=i*u-r*a,T=i*h-o*a,O=r*h-o*u,C=l*m-c*p,S=l*_-f*p,w=l*g-d*p,R=c*_-f*m,A=c*g-d*m,I=f*g-d*_,k=1/(v*I-y*A+b*R+E*w-T*S+O*C);this._viewTransform[0]=(a*I-u*A+h*R)*k,this._viewTransform[1]=(r*A-i*I-o*R)*k,this._viewTransform[2]=(m*O-_*T+g*E)*k,this._viewTransform[3]=(f*T-c*O-d*E)*k,this._viewTransform[4]=(u*w-s*I-h*S)*k,this._viewTransform[5]=(n*I-r*w+o*S)*k,this._viewTransform[6]=(_*b-p*O-g*y)*k,this._viewTransform[7]=(l*O-f*b+d*y)*k,this._viewTransform[8]=(s*A-a*w+h*C)*k,this._viewTransform[9]=(i*w-n*A-o*C)*k,this._viewTransform[10]=(p*T-m*b+g*v)*k,this._viewTransform[11]=(c*b-l*T-d*v)*k,this._viewTransform[12]=(a*S-s*R-u*C)*k,this._viewTransform[13]=(n*R-i*S+r*C)*k,this._viewTransform[14]=(m*y-p*E-_*v)*k,this._viewTransform[15]=(l*E-c*y+f*v)*k}}]),e}();s.FRUSTUM_PROJECTION=0,s.PINHOLE_PROJECTION=1,s.ORTHOGRAPHIC_PROJECTION=2,n.Camera=s},{"../core/Commands":4}],2:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e),"undefined"!=typeof self&&self.window!==self&&this._enterWorkerMode()}return r(e,[{key:"_enterWorkerMode",value:function(){this._workerMode=!0;var e=this;self.addEventListener("message",function(t){e.onMessage(t.data)})}},{key:"sendMessage",value:function(e){this._workerMode?self.postMessage(e):this.onmessage(e)}},{key:"postMessage",value:function(e){return this.onMessage(e)}},{key:"onMessage",value:function(){return null}},{key:"onmessage",value:function(){return null}}]),e}();n.Channel=o},{}],3:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e),this._time=0,this._frame=0,this._timerQueue=[],this._updatingIndex=0,this._scale=1,this._scaledTime=this._time}return r(e,[{key:"setScale",value:function(e){return this._scale=e,this}},{key:"getScale",value:function(){return this._scale}},{key:"step",value:function(e){this._frame++,this._scaledTime=this._scaledTime+(e-this._time)*this._scale,this._time=e;for(var t=0;t<this._timerQueue.length;t++)this._timerQueue[t](this._scaledTime)&&this._timerQueue.splice(t,1);return this}},{key:"now",value:function(){return this._scaledTime}},{key:"getFrame",value:function(){return this._frame}},{key:"setTimeout",value:function(e,t){var n=Array.prototype.slice.call(arguments,2),i=this._time,r=function(r){return r-i>=t?(e.apply(null,n),!0):!1};return this._timerQueue.push(r),r}},{key:"setInterval",value:function(e,t){var n=Array.prototype.slice.call(arguments,2),i=this._time,r=function(r){return r-i>=t&&(e.apply(null,n),i=r),!1};return this._timerQueue.push(r),r}},{key:"clearTimer",value:function(e){var t=this._timerQueue.indexOf(e);return-1!==t&&this._timerQueue.splice(t,1),this}}]),e}();n.Clock=o},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={INIT_DOM:0,DOM_RENDER_SIZE:1,CHANGE_TRANSFORM:2,CHANGE_SIZE:3,CHANGE_PROPERTY:4,CHANGE_CONTENT:5,CHANGE_ATTRIBUTE:6,ADD_CLASS:7,REMOVE_CLASS:8,SUBSCRIBE:9,GL_SET_DRAW_OPTIONS:10,GL_AMBIENT_LIGHT:11,GL_LIGHT_POSITION:12,GL_LIGHT_COLOR:13,MATERIAL_INPUT:14,GL_SET_GEOMETRY:15,GL_UNIFORMS:16,GL_BUFFER_DATA:17,GL_CUTOUT_STATE:18,GL_MESH_VISIBILITY:19,GL_REMOVE_MESH:20,PINHOLE_PROJECTION:21,ORTHOGRAPHIC_PROJECTION:22,CHANGE_VIEW_TRANSFORM:23,WITH:24,FRAME:25,ENGINE:26,START:27,STOP:28,TIME:29,TRIGGER:30,NEED_SIZE_FOR:31,DOM:32,READY:33,ALLOW_DEFAULT:34,PREVENT_DEFAULT:35,UNSUBSCRIBE:36,prettyPrint:function(e,t,n){var i;t=t?t:0;for(var o={i:t,result:""},s=n?n+t:e.length;o.i<s;o.i++){if(i=r[e[o.i]],!i)throw new Error("PARSE ERROR: no command registered for: "+e[o.i]);i(e,o)}return o.result}},r=[];r[i.INIT_DOM]=function(e,t){t.result+=t.i+". INIT_DOM\n    tagName: "+e[++t.i]+"\n\n"},r[i.DOM_RENDER_SIZE]=function(e,t){t.result+=t.i+". DOM_RENDER_SIZE\n    selector: "+e[++t.i]+"\n\n"},r[i.CHANGE_TRANSFORM]=function(e,t){t.result+=t.i+". CHANGE_TRANSFORM\n    val: [";for(var n=0;16>n;n++)t.result+=e[++t.i]+(15>n?", ":"");t.result+="]\n\n"},r[i.CHANGE_SIZE]=function(e,t){t.result+=t.i+". CHANGE_SIZE\n    x: "+e[++t.i]+", y: "+e[++t.i]+"\n\n"},r[i.CHANGE_PROPERTY]=function(e,t){t.result+=t.i+". CHANGE_PROPERTY\n    key: "+e[++t.i]+", value: "+e[++t.i]+"\n\n"},r[i.CHANGE_CONTENT]=function(e,t){t.result+=t.i+". CHANGE_CONTENT\n    content: "+e[++t.i]+"\n\n"},r[i.CHANGE_ATTRIBUTE]=function(e,t){t.result+=t.i+". CHANGE_ATTRIBUTE\n    key: "+e[++t.i]+", value: "+e[++t.i]+"\n\n"},r[i.ADD_CLASS]=function(e,t){t.result+=t.i+". ADD_CLASS\n    className: "+e[++t.i]+"\n\n"},r[i.REMOVE_CLASS]=function(e,t){t.result+=t.i+". REMOVE_CLASS\n    className: "+e[++t.i]+"\n\n"},r[i.SUBSCRIBE]=function(e,t){t.result+=t.i+". SUBSCRIBE\n    event: "+e[++t.i]+"\n\n"},r[i.GL_SET_DRAW_OPTIONS]=function(e,t){t.result+=t.i+". GL_SET_DRAW_OPTIONS\n    options: "+e[++t.i]+"\n\n"},r[i.GL_AMBIENT_LIGHT]=function(e,t){t.result+=t.i+". GL_AMBIENT_LIGHT\n    r: "+e[++t.i]+"g: "+e[++t.i]+"b: "+e[++t.i]+"\n\n"},r[i.GL_LIGHT_POSITION]=function(e,t){t.result+=t.i+". GL_LIGHT_POSITION\n    x: "+e[++t.i]+"y: "+e[++t.i]+"z: "+e[++t.i]+"\n\n"},r[i.GL_LIGHT_COLOR]=function(e,t){t.result+=t.i+". GL_LIGHT_COLOR\n    r: "+e[++t.i]+"g: "+e[++t.i]+"b: "+e[++t.i]+"\n\n"},r[i.MATERIAL_INPUT]=function(e,t){t.result+=t.i+". MATERIAL_INPUT\n    key: "+e[++t.i]+", value: "+e[++t.i]+"\n\n"},r[i.GL_SET_GEOMETRY]=function(e,t){t.result+=t.i+". GL_SET_GEOMETRY\n   x: "+e[++t.i]+", y: "+e[++t.i]+", z: "+e[++t.i]+"\n\n"},r[i.GL_UNIFORMS]=function(e,t){t.result+=t.i+". GL_UNIFORMS\n    key: "+e[++t.i]+", value: "+e[++t.i]+"\n\n"},r[i.GL_BUFFER_DATA]=function(e,t){t.result+=t.i+". GL_BUFFER_DATA\n    data: ";for(var n=0;5>n;n++)t.result+=e[++t.i]+", ";t.result+="\n\n"},r[i.GL_CUTOUT_STATE]=function(e,t){t.result+=t.i+". GL_CUTOUT_STATE\n    state: "+e[++t.i]+"\n\n"},r[i.GL_MESH_VISIBILITY]=function(e,t){t.result+=t.i+". GL_MESH_VISIBILITY\n    visibility: "+e[++t.i]+"\n\n"},r[i.GL_REMOVE_MESH]=function(e,t){t.result+=t.i+". GL_REMOVE_MESH\n\n"},r[i.PINHOLE_PROJECTION]=function(e,t){t.result+=t.i+". PINHOLE_PROJECTION\n    depth: "+e[++t.i]+"\n\n"},r[i.ORTHOGRAPHIC_PROJECTION]=function(e,t){t.result+=t.i+". ORTHOGRAPHIC_PROJECTION\n"},r[i.CHANGE_VIEW_TRANSFORM]=function(e,t){t.result+=t.i+". CHANGE_VIEW_TRANSFORM\n   value: [";for(var n=0;16>n;n++)t.result+=e[++t.i]+(15>n?", ":"");t.result+="]\n\n"},r[i.PREVENT_DEFAULT]=function(e,t){t.result+=t.i+". PREVENT_DEFAULT\n    value: "+e[++t.i]+"\n\n"},r[i.ALLOW_DEFAULT]=function(e,t){t.result+=t.i+". ALLOW_DEFAULT\n    value: "+e[++t.i]+"\n\n"},r[i.READY]=function(e,t){t.result+=t.i+". READY\n\n"},r[i.WITH]=function(e,t){t.result+=t.i+". **WITH**\n     path: "+e[++t.i]+"\n\n"},r[i.TIME]=function(e,t){t.result+=t.i+". TIME\n     ms: "+e[++t.i]+"\n\n"},r[i.NEED_SIZE_FOR]=function(e,t){t.result+=t.i+". NEED_SIZE_FOR\n    selector: "+e[++t.i]+"\n\n"},n.Commands=i},{}],5:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){return d.pop()||[]}function o(e){d.push(e)}function s(e,t){t.length=0;var n,i=0,r=e.length;for(n=0;r>n;n++)"/"===e[n]&&(t.push(e.substring(i,n)),i=n+1);return n-i>0&&t.push(e.substring(i,n)),t}function a(e,t){for(var n,i=e.getChildren(),r=0,o=i.length;o>r;r++)n=i[r],n&&t.push(n)}function u(e){var t=e.shift();return t?(a(t,e),t):void 0}Object.defineProperty(n,"__esModule",{value:!0});var h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=e("./Event"),c=e("./Path"),f=function(){function e(){i(this,e),this._nodes={},this.queues=[]}return h(e,[{key:"_setUpdater",value:function(e){this._updater=e;for(var t in this._nodes)this._nodes[t]._setUpdater(e)}},{key:"mount",value:function(e,t){if(!t)throw new Error("Dispatch: no node passed to mount at: "+e);if(this._nodes[e])throw new Error("Dispatch: there is a node already registered at: "+e);t._setUpdater(this._updater),this._nodes[e]=t;var n=c.Path.parent(e),i=n?this._nodes[n]:t;if(!i)throw new Error("Parent to path: "+e+" doesn't exist at expected path: "+n);var r,o,s=t.getChildren(),a=t.getComponents();if(i.isMounted()&&t._setMounted(!0,e),i.isShown()&&t._setShown(!0),i.isMounted()){for(t._setParent(i),t.onMount&&t.onMount(e),r=0,o=a.length;o>r;r++)a[r]&&a[r].onMount&&a[r].onMount(t,r);for(r=0,o=s.length;o>r;r++)s[r]&&s[r].mount?s[r].mount(e+"/"+r):s[r]&&this.mount(e+"/"+r,s[r])}if(i.isShown())for(t.onShow&&t.onShow(),r=0,o=a.length;o>r;r++)a[r]&&a[r].onShow&&a[r].onShow()}},{key:"dismount",value:function(e){var t=this._nodes[e];if(!t)throw new Error("No node registered to path: "+e);var n,i,r=t.getChildren(),o=t.getComponents();if(t.isShown())for(t._setShown(!1),t.onHide&&t.onHide(),n=0,i=o.length;i>n;n++)o[n]&&o[n].onHide&&o[n].onHide();if(t.isMounted()){for(t.onDismount&&t.onDismount(e),n=0,i=r.length;i>n;n++)r[n]&&r[n].dismount?r[n].dismount():r[n]&&this.dismount(e+"/"+n);for(n=0,i=o.length;i>n;n++)o[n]&&o[n].onDismount&&o[n].onDismount();t._setMounted(!1),t._setParent(null)}this._nodes[e]=null}},{key:"getNode",value:function(e){return this._nodes[e]}},{key:"show",value:function(e){var t=this._nodes[e];if(!t)throw new Error("No node registered to path: "+e);t.onShow&&t.onShow();for(var n=t.getComponents(),i=0,s=n.length;s>i;i++)n[i]&&n[i].onShow&&n[i].onShow();var h=r();a(t,h);for(var l;l=u(h);)this.show(l.getLocation());o(h)}},{key:"hide",value:function(e){var t=this._nodes[e];if(!t)throw new Error("No node registered to path: "+e);t.onHide&&t.onHide();for(var n=t.getComponents(),i=0,s=n.length;s>i;i++)n[i]&&n[i].onHide&&n[i].onHide();var h=r();a(t,h);for(var l;l=u(h);)this.hide(l.getLocation());o(h)}},{key:"lookupNode",value:function(e){if(!e)throw new Error("lookupNode must be called with a path");var t=r();s(e,t);for(var n=0,i=t.length;i>n;n++)t[n]=this._nodes[t[n]];return t.length=0,o(t),t[t.length-1]}},{key:"dispatch",value:function(e,t,n){if(!e)throw new Error("dispatch requires a path as it's first argument");if(!t)throw new Error("dispatch requires an event name as it's second argument");var i=this._nodes[e];if(i){n.node=i;var s=r();s.push(i);for(var a,h,l,c;a=u(s);)for(a&&a.onReceive&&a.onReceive(t,n),h=a.getComponents(),l=0,c=h.length;c>l;l++)h[l]&&h[l].onReceive&&h[l].onReceive(t,n);o(s)}}},{key:"dispatchUIEvent",value:function(e,t,n){if(!e)throw new Error("dispatchUIEvent needs a valid path to dispatch to");if(!t)throw new Error("dispatchUIEvent needs an event name as its second argument");var i;if(l.Event.call(n),i=this.getNode(e)){var r,o,s,a;for(n.node=i;i;){for(i.onReceive&&i.onReceive(t,n),o=i.getComponents(),s=0,a=o.length;a>s;s++)o[s]&&o[s].onReceive&&o[s].onReceive(t,n);if(n.propagationStopped)break;if(r=i.getParent(),r===i)return;i=r}}}}]),e}(),d=[],p=new f;n.Dispatch=p},{"./Event":6,"./Path":11}],6:[function(e,t,n){"use strict";function i(){this.propagationStopped=!1,this.stopPropagation=r}function r(){this.propagationStopped=!0}Object.defineProperty(n,"__esModule",{value:!0}),n.Event=i},{}],7:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./Clock"),s=e("./Scene"),a=e("./Channel"),u=e("./Dispatch"),h=e("../renderers/UIManager"),l=e("../renderers/Compositor"),c=e("../render-loops/RequestAnimationFrameLoop"),f=e("./TransformSystem"),d=e("./OpacitySystem"),p=e("./SizeSystem"),m=e("./Commands"),_=[m.Commands.ENGINE,m.Commands.START],g=[m.Commands.ENGINE,m.Commands.STOP],v=[m.Commands.TIME,null],y=function(){function e(){i(this,e);var t=this;u.Dispatch._setUpdater(this),this._updateQueue=[],this._nextUpdateQueue=[],this._scenes={},this._messages=v,this._inUpdate=!1,this._clock=new o.Clock,this._channel=new a.Channel,this._channel.onMessage=function(e){t.handleMessage(e)}}return r(e,[{key:"init",value:function(e){if("undefined"==typeof window)throw new Error("FamousEngine#init needs to have access to the global window object. Instantiate Compositor and UIManager manually in the UI thread.");return this.compositor=e&&e.compositor||new l.Compositor,this.renderLoop=e&&e.renderLoop||new c.RequestAnimationFrameLoop,this.uiManager=new h.UIManager(this.getChannel(),this.compositor,this.renderLoop),this}},{key:"setChannel",value:function(e){return this._channel=e,this}},{key:"getChannel",value:function(){return this._channel}},{key:"_update",value:function(){this._inUpdate=!0;var e,t=this._clock.now(),n=this._nextUpdateQueue,i=this._updateQueue;for(this._messages[1]=t,p.SizeSystem.update(),f.TransformSystem.update(),d.OpacitySystem.update();n.length;)i.unshift(n.pop());for(;i.length;)e=i.shift(),e&&e.update&&e.update(t),e&&e.onUpdate&&e.onUpdate(t);this._inUpdate=!1}},{key:"requestUpdate",value:function(e){if(!e)throw new Error("requestUpdate must be called with a class to be updated");this._inUpdate?this.requestUpdateOnNextTick(e):this._updateQueue.push(e)}},{key:"requestUpdateOnNextTick",value:function(e){this._nextUpdateQueue.push(e)}},{key:"handleMessage",value:function(e){if(!e)throw new Error("onMessage must be called with an array of messages");for(var t;e.length>0;)switch(t=e.shift()){case m.Commands.WITH:this.handleWith(e);break;case m.Commands.FRAME:this.handleFrame(e);break;default:throw new Error("received unknown command: "+t)}return this}},{key:"handleWith",value:function(e){var t=e.shift(),n=e.shift();switch(n){case m.Commands.TRIGGER:var i=e.shift(),r=e.shift();u.Dispatch.dispatchUIEvent(t,i,r);break;default:throw new Error("received unknown command: "+n)}return this}},{key:"handleFrame",value:function(e){if(!e)throw new Error("handleFrame must be called with an array of messages");if(!e.length)throw new Error("FRAME must be sent with a time");return this.step(e.shift()),this}},{key:"step",value:function(e){if(null==e)throw new Error("step must be called with a time");if(this._clock.step(e),this._update(),this._messages.length)for(this._channel.sendMessage(this._messages);this._messages.length>2;)this._messages.pop();return this}},{key:"getContext",value:function(e){if(!e)throw new Error("getContext must be called with a selector");var t=e.indexOf("/");return e=-1===t?e:e.substring(0,t),this._scenes[e]}},{key:"getClock",value:function(){return this._clock}},{key:"message",value:function(e){return this._messages.push(e),this}},{key:"createScene",value:function(e){return e=e||"body",this._scenes[e]&&this._scenes[e].dismount(),this._scenes[e]=new s.Scene(e,this),this._scenes[e]}},{key:"addScene",value:function(e){var t=e._selector,n=this._scenes[t];return n&&n!==e&&n.dismount(),e.isMounted()||e.mount(e.getSelector()),this._scenes[t]=e,this}},{key:"removeScene",value:function(e){var t=e._selector,n=this._scenes[t];return n&&n===e&&(e.isMounted()&&e.dismount(),delete this._scenes[t]),this}},{key:"startRenderLoop",value:function(){return this._channel.sendMessage(_),this}},{key:"stopRenderLoop",value:function(){return this._channel.sendMessage(g),this}},{key:"startEngine",value:function(){return console.warn("FamousEngine.startEngine is deprecated! Use FamousEngine.startRenderLoop instead!"),this.startRenderLoop()}},{key:"stopEngine",value:function(){return console.warn("FamousEngine.stopEngine is deprecated! Use FamousEngine.stopRenderLoop instead!"),this.stopRenderLoop()}}]),e}(),b=new y;n.FamousEngine=b},{"../render-loops/RequestAnimationFrameLoop":35,"../renderers/Compositor":36,"../renderers/UIManager":38,"./Channel":2,"./Clock":3,"./Commands":4,"./Dispatch":5,"./OpacitySystem":10,"./Scene":13,"./SizeSystem":15,"./TransformSystem":17}],8:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./SizeSystem"),s=e("./Dispatch"),a=e("./TransformSystem"),u=e("./OpacitySystem"),h=e("./Size"),l=e("./Opacity"),c=e("./Transform"),f=function(){function e(){i(this,e),this._requestingUpdate=!1,this._inUpdate=!1,this._mounted=!1,this._shown=!0,this._updater=null,this._UIEvents=[],this._updateQueue=[],this._nextUpdateQueue=[],this._freedComponentIndicies=[],this._components=[],this._freedChildIndicies=[],this._children=[],this._fullChildren=[],this._parent=null,this._id=null,this._transformID=null,this._sizeID=null,this._opacityID=null,this.constructor.NO_DEFAULT_COMPONENTS||this._init()}return r(e,[{key:"_init",value:function(){this._transformID=this.addComponent(new c.Transform),this._sizeID=this.addComponent(new h.Size),this._opacityID=this.addComponent(new l.Opacity)}},{key:"_setParent",value:function(e){this._parent&&-1!==this._parent.getChildren().indexOf(this)&&this._parent.removeChild(this),this._parent=e}},{key:"_setMounted",value:function(e,t){this._mounted=e,this._id=t?t:null}},{key:"_setShown",value:function(e){this._shown=e}},{key:"_setUpdater",value:function(e){this._updater=e,this._requestingUpdate&&this._updater.requestUpdate(this)}},{key:"getLocation",value:function(){return this._id}},{key:"emit",value:function(e,t){return s.Dispatch.dispatch(this.getLocation(),e,t),this}},{key:"sendDrawCommand",value:function(e){return this._updater.message(e),this}},{key:"getValue",value:function(){var e=this._children.length,t=this._components.length,n=0,i={location:this.getId(),spec:{location:this.getId(),showState:{mounted:this.isMounted(),shown:this.isShown(),opacity:1},offsets:{mountPoint:[0,0,0],align:[0,0,0],origin:[0,0,0]},vectors:{position:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1]},size:{sizeMode:[0,0,0],proportional:[1,1,1],differential:[0,0,0],absolute:[0,0,0],render:[0,0,0]}},UIEvents:this._UIEvents,components:[],children:[]};if(i.location){var r=a.TransformSystem.get(this.getId()),s=o.SizeSystem.get(this.getId()),h=u.OpacitySystem.get(this.getId());for(i.spec.showState.opacity=h.getOpacity(),n=0;3>n;n++)i.spec.offsets.mountPoint[n]=r.offsets.mountPoint[n],i.spec.offsets.align[n]=r.offsets.align[n],i.spec.offsets.origin[n]=r.offsets.origin[n],i.spec.vectors.position[n]=r.vectors.position[n],i.spec.vectors.rotation[n]=r.vectors.rotation[n],i.spec.vectors.scale[n]=r.vectors.scale[n],i.spec.size.sizeMode[n]=s.sizeMode[n],i.spec.size.proportional[n]=s.proportionalSize[n],i.spec.size.differential[n]=s.differentialSize[n],i.spec.size.absolute[n]=s.absoluteSize[n],i.spec.size.render[n]=s.renderSize[n];i.spec.vectors.rotation[3]=r.vectors.rotation[3]}for(n=0;e>n;n++)this._children[n]&&this._children[n].getValue&&i.children.push(this._children[n].getValue());for(n=0;t>n;n++)this._components[n]&&this._components[n].getValue&&i.components.push(this._components[n].getValue());return i}},{key:"getComputedValue",value:function(){console.warn("Node.getComputedValue is depricated. Use Node.getValue instead");for(var e=this._children.length,t={location:this.getId(),computedValues:{transform:this.isMounted()?a.TransformSystem.get(this.getLocation()).getLocalTransform():null,size:this.isMounted()?o.SizeSystem.get(this.getLocation()).get():null,opacity:this.isMounted()?u.OpacitySystem.get(this.getLocation()).get():null},children:[]},n=0;e>n;n++)this._children[n]&&this._children[n].getComputedValue&&t.children.push(this._children[n].getComputedValue());return t}},{key:"getChildren",value:function(){return this._fullChildren}},{key:"getRawChildren",value:function(){return this._children}},{key:"getParent",value:function(){return this._parent}},{key:"requestUpdate",value:function(e){return this._inUpdate||!this.isMounted()?this.requestUpdateOnNextTick(e):(-1===this._updateQueue.indexOf(e)&&(this._updateQueue.push(e),this._requestingUpdate||this._requestUpdate()),this)}},{key:"requestUpdateOnNextTick",value:function(e){return-1===this._nextUpdateQueue.indexOf(e)&&this._nextUpdateQueue.push(e),this}},{key:"isMounted",value:function(){return this._mounted}},{key:"isRendered",value:function(){return this._mounted&&this._shown}},{key:"isShown",value:function(){return this._shown}},{key:"getOpacity",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return u.OpacitySystem.get(this.getLocation()).getOpacity();throw new Error("This node does not have access to an opacity component")}return this.getComponent(this._opacityID).getOpacity()}},{key:"getMountPoint",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return a.TransformSystem.get(this.getLocation()).getMountPoint();throw new Error("This node does not have access to a transform component")}return this.getComponent(this._transformID).getMountPoint()}},{key:"getAlign",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return a.TransformSystem.get(this.getLocation()).getAlign();throw new Error("This node does not have access to a transform component")}return this.getComponent(this._transformID).getAlign()}},{key:"getOrigin",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return a.TransformSystem.get(this.getLocation()).getOrigin();throw new Error("This node does not have access to a transform component")}return this.getComponent(this._transformID).getOrigin()}},{key:"getPosition",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return a.TransformSystem.get(this.getLocation()).getPosition();throw new Error("This node does not have access to a transform component")}return this.getComponent(this._transformID).getPosition()}},{key:"getRotation",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return a.TransformSystem.get(this.getLocation()).getRotation();throw new Error("This node does not have access to a transform component")}return this.getComponent(this._transformID).getRotation()}},{key:"getScale",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return a.TransformSystem.get(this.getLocation()).getScale();throw new Error("This node does not have access to a transform component")}return this.getComponent(this._transformID).getScale()}},{key:"getSizeMode",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return o.SizeSystem.get(this.getLocation()).getSizeMode();throw new Error("This node does not have access to a size component")}return this.getComponent(this._sizeID).getSizeMode()}},{key:"getProportionalSize",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return o.SizeSystem.get(this.getLocation()).getProportional();throw new Error("This node does not have access to a size component")}return this.getComponent(this._sizeID).getProportional()}},{key:"getDifferentialSize",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return o.SizeSystem.get(this.getLocation()).getDifferential();throw new Error("This node does not have access to a size component")}return this.getComponent(this._sizeID).getDifferential()}},{key:"getAbsoluteSize",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return o.SizeSystem.get(this.getLocation()).getAbsolute();throw new Error("This node does not have access to a size component")}return this.getComponent(this._sizeID).getAbsolute()}},{key:"getRenderSize",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return o.SizeSystem.get(this.getLocation()).getRender();throw new Error("This node does not have access to a size component")}return this.getComponent(this._sizeID).getRender()}},{key:"getSize",value:function(){if(this.constructor.NO_DEFAULT_COMPONENTS){if(this.isMounted())return o.SizeSystem.get(this.getLocation()).get();throw new Error("This node does not have access to a size component")}return this.getComponent(this._sizeID).get()}},{key:"getTransform",value:function(){return a.TransformSystem.get(this.getLocation())}},{key:"getUIEvents",value:function(){return this._UIEvents}},{key:"addChild",value:function(t){var n=t?this._children.indexOf(t):-1;return t=t?t:new e,-1===n&&(n=this._freedChildIndicies.length?this._freedChildIndicies.pop():this._children.length,this._children[n]=t,this._fullChildren.push(t)),this.isMounted()&&t.mount(this.getLocation()+"/"+n),t}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);if(t>-1){this._freedChildIndicies.push(t),this._children[t]=null,e.isMounted()&&e.dismount();var n=this._fullChildren.indexOf(e),i=this._fullChildren.length,r=0;for(r=n;i-1>r;r++)this._fullChildren[r]=this._fullChildren[r+1];return this._fullChildren.pop(),!0}return!1}},{key:"addComponent",value:function(e){var t=this._components.indexOf(e);return-1===t&&(t=this._freedComponentIndicies.length?this._freedComponentIndicies.pop():this._components.length,this._components[t]=e,this.isMounted()&&e.onMount&&e.onMount(this,t),this.isShown()&&e.onShow&&e.onShow()),t}},{key:"getComponent",value:function(e){return this._components[e]}},{key:"removeComponent",value:function(e){var t=this._components.indexOf(e);return-1!==t&&(this._freedComponentIndicies.push(t),this.isShown()&&e.onHide&&e.onHide(),this.isMounted()&&e.onDismount&&e.onDismount(),this._components[t]=null),e}},{key:"removeUIEvent",value:function(e){var t,n=this.getUIEvents(),i=this._components,r=n.indexOf(e);if(-1!==r){n.splice(r,1);for(var o=0,s=i.length;s>o;o++)t=i[o],t&&t.onRemoveUIEvent&&t.onRemoveUIEvent(e)}}},{key:"addUIEvent",value:function(e){var t,n=this.getUIEvents(),i=this._components,r=-1!==n.indexOf(e);if(!r){n.push(e);for(var o=0,s=i.length;s>o;o++)t=i[o],t&&t.onAddUIEvent&&t.onAddUIEvent(e)}return this}},{key:"_requestUpdate",value:function(e){(e||!this._requestingUpdate)&&(this._updater&&this._updater.requestUpdate(this),this._requestingUpdate=!0)}},{key:"_vecOptionalSet",value:function(e,t,n){return null!=n&&e[t]!==n?(e[t]=n,this._requestingUpdate||this._requestUpdate(),!0):!1}},{key:"show",value:function(){return s.Dispatch.show(this.getLocation()),this._shown=!0,this}},{key:"hide",value:function(){return s.Dispatch.hide(this.getLocation()),this._shown=!1,this}},{key:"setAlign",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a transform component");a.TransformSystem.get(this.getLocation()).setAlign(e,t,n)}else this.getComponent(this._transformID).setAlign(e,t,n);return this}},{key:"setMountPoint",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a transform component");
a.TransformSystem.get(this.getLocation()).setMountPoint(e,t,n)}else this.getComponent(this._transformID).setMountPoint(e,t,n);return this}},{key:"setOrigin",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a transform component");a.TransformSystem.get(this.getLocation()).setOrigin(e,t,n)}else this.getComponent(this._transformID).setOrigin(e,t,n);return this}},{key:"setPosition",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a transform component");a.TransformSystem.get(this.getLocation()).setPosition(e,t,n)}else this.getComponent(this._transformID).setPosition(e,t,n);return this}},{key:"setRotation",value:function(e,t,n,i){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a transform component");a.TransformSystem.get(this.getLocation()).setRotation(e,t,n,i)}else this.getComponent(this._transformID).setRotation(e,t,n,i);return this}},{key:"setScale",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a transform component");a.TransformSystem.get(this.getLocation()).setScale(e,t,n)}else this.getComponent(this._transformID).setScale(e,t,n);return this}},{key:"setOpacity",value:function(e){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to an opacity component");u.OpacitySystem.get(this.getLocation()).setOpacity(e)}else this.getComponent(this._opacityID).setOpacity(e);return this}},{key:"setSizeMode",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a size component");o.SizeSystem.get(this.getLocation()).setSizeMode(e,t,n)}else this.getComponent(this._sizeID).setSizeMode(e,t,n);return this}},{key:"setProportionalSize",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a size component");o.SizeSystem.get(this.getLocation()).setProportional(e,t,n)}else this.getComponent(this._sizeID).setProportional(e,t,n);return this}},{key:"setDifferentialSize",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a size component");o.SizeSystem.get(this.getLocation()).setDifferential(e,t,n)}else this.getComponent(this._sizeID).setDifferential(e,t,n);return this}},{key:"setAbsoluteSize",value:function(e,t,n){if(this.constructor.NO_DEFAULT_COMPONENTS){if(!this.isMounted())throw new Error("This node does not have access to a size component");o.SizeSystem.get(this.getLocation()).setAbsolute(e,t,n)}else this.getComponent(this._sizeID).setAbsolute(e,t,n);return this}},{key:"getFrame",value:function(){return this._updater.getFrame()}},{key:"getComponents",value:function(){return this._components}},{key:"update",value:function(e){this._inUpdate=!0;for(var t,n=this._nextUpdateQueue,i=this._updateQueue;n.length;)i.unshift(n.pop());for(;i.length;)t=this._components[i.shift()],t&&t.onUpdate&&t.onUpdate(e);return this._inUpdate=!1,this._requestingUpdate=!1,this.isMounted()?this._nextUpdateQueue.length&&(this._updater.requestUpdateOnNextTick(this),this._requestingUpdate=!0):(this._parent=null,this._id=null),this}},{key:"mount",value:function(e){if(this.isMounted())throw new Error("Node is already mounted at: "+this.getLocation());return this.constructor.NO_DEFAULT_COMPONENTS?(a.TransformSystem.registerTransformAtPath(e),u.OpacitySystem.registerOpacityAtPath(e),o.SizeSystem.registerSizeAtPath(e)):(a.TransformSystem.registerTransformAtPath(e,this.getComponent(this._transformID)),u.OpacitySystem.registerOpacityAtPath(e,this.getComponent(this._opacityID)),o.SizeSystem.registerSizeAtPath(e,this.getComponent(this._sizeID))),s.Dispatch.mount(e,this),this._requestingUpdate||this._requestUpdate(),this}},{key:"dismount",value:function(){if(!this.isMounted())throw new Error("Node is not mounted");var e=this.getLocation();a.TransformSystem.deregisterTransformAtPath(e),o.SizeSystem.deregisterSizeAtPath(e),u.OpacitySystem.deregisterOpacityAtPath(e),s.Dispatch.dismount(e),this._requestingUpdate||this._requestUpdate()}},{key:"getId",value:function(){return this.getLocation()}}]),e}();f.RELATIVE_SIZE=0,f.ABSOLUTE_SIZE=1,f.RENDER_SIZE=2,f.DEFAULT_SIZE=0,f.NO_DEFAULT_COMPONENTS=!1,n.Node=f},{"./Dispatch":5,"./Opacity":9,"./OpacitySystem":10,"./Size":14,"./SizeSystem":15,"./Transform":16,"./TransformSystem":17}],9:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.local=1,this.global=1,this.opacity=1,this.parent=t?t:null,this.breakPoint=!1,this.calculatingWorldOpacity=!1}return r(e,[{key:"reset",value:function(){this.parent=null,this.breakPoint=!1}},{key:"setParent",value:function(e){this.parent=e}},{key:"getParent",value:function(){return this.parent}},{key:"setBreakPoint",value:function(){this.breakPoint=!0,this.calculatingWorldOpacity=!0}},{key:"setCalculateWorldOpacity",value:function(){this.calculatingWorldOpacity=!0}},{key:"isBreakPoint",value:function(){return this.breakPoint}},{key:"getLocalOpacity",value:function(){return this.local}},{key:"getWorldOpacity",value:function(){if(!this.isBreakPoint()&&!this.calculatingWorldOpacity)throw new Error("This opacity is not calculating world transforms");return this.global}},{key:"calculate",value:function(e){return!this.parent||this.parent.isBreakPoint()?this.fromNode(e):this.fromNodeWithParent(e)}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"calculateWorldOpacity",value:function(){for(var e=this.parent,t=this.global;e&&!e.isBreakPoint();)e=e.parent;return e?this.global=e.getWorldOpacity()*this.local:this.global=this.local,t!==this.global}},{key:"fromNode",value:function(){var t=0;return this.opacity!==this.local&&(t|=e.LOCAL_CHANGED),this.local=this.opacity,this.calculatingWorldOpacity&&this.calculateWorldOpacity()&&(t|=e.WORLD_CHANGED),t}},{key:"fromNodeWithParent",value:function(){var t=0,n=this.local;return this.local=this.parent.getLocalOpacity()*this.opacity,this.calculatingWorldOpacity&&this.calculateWorldOpacity()&&(t|=e.WORLD_CHANGED),n!==this.local&&(t|=e.LOCAL_CHANGED),t}}]),e}();o.WORLD_CHANGED=1,o.LOCAL_CHANGED=2,n.Opacity=o},{}],10:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){e.onOpacityChange&&e.onOpacityChange(n);for(var i=0,r=t.length;r>i;i++)t[i]&&t[i].onOpacityChange&&t[i].onOpacityChange(n)}function o(e,t,n){e.onLocalOpacityChange&&e.onLocalOpacityChange(n);for(var i=0,r=t.length;r>i;i++)t[i]&&t[i].onLocalOpacityChange&&t[i].onLocalOpacityChange(n)}function s(e,t,n){e.onWorldOpacityChange&&e.onWorldOpacityChange(n);for(var i=0,r=t.length;r>i;i++)t[i]&&t[i].onWorldOpacityChange&&t[i].onWorldOpacityChange(n)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=e("./Path"),h=e("./Opacity"),l=e("./Dispatch"),c=e("./PathStore"),f=function(){function e(){i(this,e),this.pathStore=new c.PathStore}return a(e,[{key:"registerOpacityAtPath",value:function(e,t){if(!u.Path.depth(e))return this.pathStore.insert(e,t?t:new h.Opacity);var n=this.pathStore.get(u.Path.parent(e));if(!n)throw new Error("No parent opacity registered at expected path: "+u.Path.parent(e));t&&t.setParent(n),this.pathStore.insert(e,t?t:new h.Opacity(n))}},{key:"deregisterOpacityAtPath",value:function(e){this.pathStore.remove(e)}},{key:"makeBreakPointAt",value:function(e){var t=this.pathStore.get(e);if(!t)throw new Error("No opacity Registered at path: "+e);t.setBreakPoint()}},{key:"makeCalculateWorldOpacityAt",value:function(e){var t=this.pathStore.get(e);if(!t)throw new Error("No opacity opacity at path: "+e);t.setCalculateWorldOpacity()}},{key:"get",value:function(e){return this.pathStore.get(e)}},{key:"update",value:function(){for(var e,t,n,i,a=this.pathStore.getItems(),u=this.pathStore.getPaths(),c=0,f=a.length;f>c;c++)n=l.Dispatch.getNode(u[c]),n&&(i=n.getComponents(),e=a[c],(t=e.calculate())&&(r(n,i,e),t&h.Opacity.LOCAL_CHANGED&&o(n,i,e.getLocalOpacity()),t&h.Opacity.WORLD_CHANGED&&s(n,i,e.getWorldOpacity())))}}]),e}(),d=new f;n.OpacitySystem=d},{"./Dispatch":5,"./Opacity":9,"./Path":11,"./PathStore":12}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={hasTrailingSlash:function(e){return"/"===e[e.length-1]},depth:function(e){for(var t=0,n=e.length,i=this.hasTrailingSlash(e)?n-1:n,r=0;i>r;r++)t+="/"===e[r]?1:0;return t},index:function(e){for(var t=e.length,n=this.hasTrailingSlash(e)?t-1:t;n--&&"/"!==e[n];);var i=parseInt(e.substring(n+1));return isNaN(i)?0:i},indexAtDepth:function(e,t){for(var n=0,i=e.length,r=0;i>n;n++)if("/"===e[n]&&r++,r===t)return e=e.substring(n?n+1:n),r=e.indexOf("/"),e=-1===r?e:e.substring(0,r),r=parseInt(e),isNaN(r)?e:r},parent:function(e){return e.substring(0,e.lastIndexOf("/",e.length-2))},isChildOf:function(e,t){return this.isDescendentOf(e,t)&&this.depth(e)===this.depth(t)+1},isDescendentOf:function(e,t){return e===t?!1:(e=this.hasTrailingSlash(e)?e:e+"/",t=this.hasTrailingSlash(t)?t:t+"/",this.depth(t)<this.depth(e)&&0===e.indexOf(t))},getSelector:function(e){var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}};n.Path=i},{}],12:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./Path"),s=function(){function e(){i(this,e),this.items=[],this.paths=[],this.memo={}}return r(e,[{key:"insert",value:function(e,t){var n=this.paths,i=n.indexOf(e);if(-1!==i)throw new Error("item already exists at path: "+e);for(var r=0,s=o.Path.depth(e),a=o.Path.index(e);n[r]&&s>=o.Path.depth(n[r]);)r++;for(;n[r]&&s===o.Path.depth(n[r])&&a<o.Path.index(n[r]);)r++;n.splice(r,0,e),this.items.splice(r,0,t),this.memo[e]=r;for(var u=this.paths.length;u>r;r++)this.memo[this.paths[r]]=null}},{key:"remove",value:function(e){var t=this.paths,n=this.memo[e]?this.memo[e]:t.indexOf(e);if(-1===n)throw new Error("Cannot remove. No item exists at path: "+e);t.splice(n,1),this.items.splice(n,1),this.memo[e]=null;for(var i=this.paths.length;i>n;n++)this.memo[this.paths[n]]=null}},{key:"get",value:function(e){if(this.memo[e])return this.items[this.memo[e]];var t=this.paths.indexOf(e);return-1===t?void 0:(this.memo[e]=t,this.items[t])}},{key:"getItems",value:function(){return this.items}},{key:"getPaths",value:function(){return this.paths}}]),e}();n.PathStore=s},{"./Path":11}],13:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./Node"),u=e("./Dispatch"),h=e("./Commands"),l=e("./TransformSystem"),c=e("./OpacitySystem"),f=e("./SizeSystem"),d=function(e){function t(e,n){if(i(this,t),!e)throw new Error("Scene needs to be created with a DOM selector");if(!n)throw new Error("Scene needs to be created with a class like Famous");s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._globalUpdater=n,this._selector=e,this.mount(e),this._globalUpdater.message(h.Commands.NEED_SIZE_FOR).message(e),this.show()}return r(t,e),o(t,[{key:"getUpdater",value:function(){return this._updater}},{key:"getSelector",value:function(){return this._selector}},{key:"getDispatch",value:function(){return console.warn("Scene#getDispatch is deprecated, require the dispatch directly"),u.Dispatch}},{key:"onReceive",value:function(e,t){if("CONTEXT_RESIZE"===e){if(t.length<2)throw new Error("CONTEXT_RESIZE's payload needs to be at least a pair of pixel sizes");this.setSizeMode("absolute","absolute","absolute"),this.setAbsoluteSize(t[0],t[1],t[2]?t[2]:0),this._updater.message(h.Commands.WITH).message(this._selector).message(h.Commands.READY)}}},{key:"mount",value:function(e){if(this.isMounted())throw new Error("Scene is already mounted at: "+this.getLocation());u.Dispatch.mount(e,this),this._id=e,this._mounted=!0,this._parent=this,l.TransformSystem.registerTransformAtPath(e),c.OpacitySystem.registerOpacityAtPath(e),f.SizeSystem.registerSizeAtPath(e)}}]),t}(a.Node);d.NO_DEFAULT_COMPONENTS=!0,n.Scene=d},{"./Commands":4,"./Dispatch":5,"./Node":8,"./OpacitySystem":10,"./SizeSystem":15,"./TransformSystem":17}],14:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){return null!=n&&e[t]!==n?(e[t]=n,!0):!1}function o(e,t,n,i){var o=!1;return o=r(e,0,t)||o,o=r(e,1,n)||o,o=r(e,2,i)||o}function s(e){if(e.constructor===String)switch(e.toLowerCase()){case"relative":case"default":return l.RELATIVE;case"absolute":return l.ABSOLUTE;case"render":return l.RENDER;default:throw new Error("unknown size mode: "+e)}else if(0>e||e>l.RENDER)throw new Error("unknown size mode: "+e);return e}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=[1,1,1],h=[0,0,0],l=function(){function e(t){i(this,e),this.finalSize=new Float32Array(3),this.sizeChanged=!1,this.sizeMode=new Uint8Array(3),this.sizeModeChanged=!1,this.absoluteSize=new Float32Array(3),this.absoluteSizeChanged=!1,this.proportionalSize=new Float32Array(u),this.proportionalSizeChanged=!1,this.differentialSize=new Float32Array(3),this.differentialSizeChanged=!1,this.renderSize=new Float32Array(3),this.renderSizeChanged=!1,this.parent=null!=t?t:null}return a(e,[{key:"setParent",value:function(e){return this.parent=e,this}},{key:"getParent",value:function(){return this.parent}},{key:"setSizeMode",value:function(e,t,n){return null!=e&&(e=s(e)),null!=t&&(t=s(t)),null!=n&&(n=s(n)),this.sizeModeChanged=o(this.sizeMode,e,t,n),this}},{key:"getSizeMode",value:function(){return this.sizeMode}},{key:"setAbsolute",value:function(e,t,n){return this.absoluteSizeChanged=o(this.absoluteSize,e,t,n),this}},{key:"getAbsolute",value:function(){return this.absoluteSize}},{key:"setProportional",value:function(e,t,n){return this.proportionalSizeChanged=o(this.proportionalSize,e,t,n),this}},{key:"getProportional",value:function(){return this.proportionalSize}},{key:"setDifferential",value:function(e,t,n){return this.differentialSizeChanged=o(this.differentialSize,e,t,n),this}},{key:"getDifferential",value:function(){return this.differentialSize}},{key:"get",value:function(){return this.finalSize}},{key:"fromComponents",value:function(t){for(var n,i,r=this.sizeMode,o=this.finalSize,s=this.parent?this.parent.get():h,a=!1,u=t.length,l=0;3>l;l++){switch(n=o[l],r[l]){case e.RELATIVE:o[l]=s[l]*this.proportionalSize[l]+this.differentialSize[l];break;case e.ABSOLUTE:o[l]=this.absoluteSize[l];break;case e.RENDER:var c,f;for(i=0;u>i;i++)f=t[i],f&&f.getRenderSize&&(c=f.getRenderSize()[l],o[l]=o[l]<c||0===o[l]?c:o[l])}a=a||n!==o[l]}return this.sizeChanged=a,a}}]),e}();l.RELATIVE=0,l.ABSOLUTE=1,l.RENDER=2,l.DEFAULT=l.RELATIVE,n.Size=l},{}],15:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){var i=n.getSizeMode(),r=i[0],o=i[1],s=i[2];e.onSizeModeChange&&e.onSizeModeChange(r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onSizeModeChange&&t[a].onSizeModeChange(r,o,s);n.sizeModeChanged=!1}function o(e,t,n){var i=n.getAbsolute(),r=i[0],o=i[1],s=i[2];e.onAbsoluteSizeChange&&e.onAbsoluteSizeChange(r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onAbsoluteSizeChange&&t[a].onAbsoluteSizeChange(r,o,s);n.absoluteSizeChanged=!1}function s(e,t,n){var i=n.getProportional(),r=i[0],o=i[1],s=i[2];e.onProportionalSizeChange&&e.onProportionalSizeChange(r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onProportionalSizeChange&&t[a].onProportionalSizeChange(r,o,s);n.proportionalSizeChanged=!1}function a(e,t,n){var i=n.getDifferential(),r=i[0],o=i[1],s=i[2];e.onDifferentialSizeChange&&e.onDifferentialSizeChange(r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onDifferentialSizeChange&&t[a].onDifferentialSizeChange(r,o,s);n.differentialSizeChanged=!1}function u(e,t,n){var i=n.getRenderSize(),r=i[0],o=i[1],s=i[2];e.onRenderSizeChange&&e.onRenderSizeChange(r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onRenderSizeChange&&t[a].onRenderSizeChange(r,o,s);n.renderSizeChanged=!1}function h(e,t,n){var i=n.get(),r=i[0],o=i[1],s=i[2];e.onSizeChange&&e.onSizeChange(r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onSizeChange&&t[a].onSizeChange(r,o,s);n.sizeChanged=!1}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=e("./PathStore"),f=e("./Size"),d=e("./Dispatch"),p=e("./Path"),m=function(){function e(){i(this,e),this.pathStore=new c.PathStore}return l(e,[{key:"registerSizeAtPath",value:function(e,t){if(!p.Path.depth(e))return this.pathStore.insert(e,t?t:new f.Size);var n=this.pathStore.get(p.Path.parent(e));if(!n)throw new Error("No parent size registered at expected path: "+p.Path.parent(e));t&&t.setParent(n),this.pathStore.insert(e,t?t:new f.Size(n))}},{key:"deregisterSizeAtPath",value:function(e){this.pathStore.remove(e)}},{key:"get",value:function(e){return this.pathStore.get(e)}},{key:"update",value:function(){var e,t,n,i,l,c=this.pathStore.getItems(),f=this.pathStore.getPaths();for(n=0,i=c.length;i>n;n++)e=d.Dispatch.getNode(f[n]),l=e.getComponents(),e&&(t=c[n],t.sizeModeChanged&&r(e,l,t),t.absoluteSizeChanged&&o(e,l,t),t.proportionalSizeChanged&&s(e,l,t),t.differentialSizeChanged&&a(e,l,t),t.renderSizeChanged&&u(e,l,t),t.fromComponents(l)&&h(e,l,t))}}]),e}(),_=new m;n.SizeSystem=_},{"./Dispatch":5,"./Path":11,"./PathStore":12,"./Size":14}],16:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){var n=t.getLocalTransform(),i=e.getSize(),r=t.vectors,o=t.offsets,s=e.getParent().getSize(),a=0,u=n[0],h=n[1],l=n[2],c=n[4],d=n[5],p=n[6],m=n[8],_=n[9],g=n[10],v=n[12],y=n[13],b=n[14],E=r.position[0],T=r.position[1],O=r.position[2],C=r.rotation[0],S=r.rotation[1],w=r.rotation[2],R=r.rotation[3],A=r.scale[0],I=r.scale[1],k=r.scale[2],N=o.align[0]*s[0],P=o.align[1]*s[1],L=o.align[2]*s[2],M=o.mountPoint[0]*i[0],D=o.mountPoint[1]*i[1],U=o.mountPoint[2]*i[2],x=o.origin[0]*i[0],F=o.origin[1]*i[1],z=o.origin[2]*i[2],H=R*C,G=R*S,j=R*w,W=C*C,B=S*S,V=w*w,q=C*S,Y=C*w,K=S*w;return n[0]=(1-2*(B+V))*A,n[1]=2*(q+j)*A,n[2]=2*(Y-G)*A,n[3]=0,n[4]=2*(q-j)*I,n[5]=(1-2*(W+V))*I,n[6]=2*(K+H)*I,n[7]=0,n[8]=2*(Y+G)*k,n[9]=2*(K-H)*k,n[10]=(1-2*(W+B))*k,n[11]=0,n[12]=N+E-M+x-(n[0]*x+n[4]*F+n[8]*z),n[13]=P+T-D+F-(n[1]*x+n[5]*F+n[9]*z),n[14]=L+O-U+z-(n[2]*x+n[6]*F+n[10]*z),n[15]=1,t.calculatingWorldMatrix&&t.calculateWorldMatrix()&&(a|=f.WORLD_CHANGED),(u!==n[0]||h!==n[1]||l!==n[2]||c!==n[4]||d!==n[5]||p!==n[6]||m!==n[8]||_!==n[9]||g!==n[10]||v!==n[12]||y!==n[13]||b!==n[14])&&(a|=f.LOCAL_CHANGED),a}function o(e,t){var n=t.getLocalTransform(),i=t.parent.getLocalTransform(),r=e.getSize(),o=t.vectors,s=t.offsets,a=e.getParent().getSize(),u=!1,h=n[0],l=n[1],c=n[2],d=n[4],p=n[5],m=n[6],_=n[8],g=n[9],v=n[10],y=n[12],b=n[13],E=n[14],T=i[0],O=i[1],C=i[2],S=i[4],w=i[5],R=i[6],A=i[8],I=i[9],k=i[10],N=i[12],P=i[13],L=i[14],M=o.position[0],D=o.position[1],U=o.position[2],x=o.rotation[0],F=o.rotation[1],z=o.rotation[2],H=o.rotation[3],G=o.scale[0],j=o.scale[1],W=o.scale[2],B=s.align[0]*a[0],V=s.align[1]*a[1],q=s.align[2]*a[2],Y=s.mountPoint[0]*r[0],K=s.mountPoint[1]*r[1],X=s.mountPoint[2]*r[2],Q=s.origin[0]*r[0],Z=s.origin[1]*r[1],J=s.origin[2]*r[2],$=H*x,ee=H*F,te=H*z,ne=x*x,ie=F*F,re=z*z,oe=x*F,se=x*z,ae=F*z,ue=(1-2*(ie+re))*G,he=2*(oe+te)*G,le=2*(se-ee)*G,ce=2*(oe-te)*j,fe=(1-2*(ne+re))*j,de=2*(ae+$)*j,pe=2*(se+ee)*W,me=2*(ae-$)*W,_e=(1-2*(ne+ie))*W,ge=B+M-Y+Q-(ue*Q+ce*Z+pe*J),ve=V+D-K+Z-(he*Q+fe*Z+me*J),ye=q+U-X+J-(le*Q+de*Z+_e*J);return n[0]=T*ue+S*he+A*le,n[1]=O*ue+w*he+I*le,n[2]=C*ue+R*he+k*le,n[3]=0,n[4]=T*ce+S*fe+A*de,n[5]=O*ce+w*fe+I*de,n[6]=C*ce+R*fe+k*de,n[7]=0,n[8]=T*pe+S*me+A*_e,n[9]=O*pe+w*me+I*_e,n[10]=C*pe+R*me+k*_e,n[11]=0,n[12]=T*ge+S*ve+A*ye+N,n[13]=O*ge+w*ve+I*ye+P,n[14]=C*ge+R*ve+k*ye+L,n[15]=1,t.calculatingWorldMatrix&&t.calculateWorldMatrix()&&(u|=f.WORLD_CHANGED),(h!==n[0]||l!==n[1]||c!==n[2]||d!==n[4]||p!==n[5]||m!==n[6]||_!==n[8]||g!==n[9]||v!==n[10]||y!==n[12]||b!==n[13]||E!==n[14])&&(u|=f.LOCAL_CHANGED),u}function s(e,t,n){var i,r=t[0],o=t[1],s=t[2],a=t[4],u=t[5],h=t[6],l=t[8],c=t[9],f=t[10],d=t[12],p=t[13],m=t[14],_=!1,g=n[0],v=n[1],y=n[2],b=n[3];return i=g*r+v*a+y*l+b*d,_=_?_:e[0]===i,e[0]=i,i=g*o+v*u+y*c+b*p,_=_?_:e[1]===i,e[1]=i,i=g*s+v*h+y*f+b*m,_=_?_:e[2]===i,e[2]=i,e[3]=0,g=n[4],v=n[5],y=n[6],b=n[7],i=g*r+v*a+y*l+b*d,_=_?_:e[4]===i,e[4]=i,i=g*o+v*u+y*c+b*p,_=_?_:e[5]===i,e[5]=i,i=g*s+v*h+y*f+b*m,_=_?_:e[6]===i,e[6]=i,e[7]=0,g=n[8],v=n[9],y=n[10],b=n[11],i=g*r+v*a+y*l+b*d,_=_?_:e[8]===i,e[8]=i,i=g*o+v*u+y*c+b*p,_=_?_:e[9]===i,e[9]=i,i=g*s+v*h+y*f+b*m,_=_?_:e[10]===i,e[10]=i,e[11]=0,g=n[12],v=n[13],y=n[14],b=n[15],i=g*r+v*a+y*l+b*d,_=_?_:e[12]===i,e[12]=i,i=g*o+v*u+y*c+b*p,_=_?_:e[13]===i,e[13]=i,i=g*s+v*h+y*f+b*m,_=_?_:e[14]===i,e[14]=i,e[15]=1,_}function a(e,t,n){return null!=n&&e[t]!==n?(e[t]=n,!0):!1}function u(e,t,n,i,r){var o=!1;return o=a(e,0,t)||o,o=a(e,1,n)||o,o=a(e,2,i)||o,null!=r&&(o=a(e,3,r)||o),o}Object.defineProperty(n,"__esModule",{value:!0});var h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=[0,0,0,1],c=[1,1,1],f=function(){function e(t){i(this,e),this.local=new Float32Array(e.IDENT),this.global=new Float32Array(e.IDENT),this.offsets={align:new Float32Array(3),alignChanged:!1,mountPoint:new Float32Array(3),mountPointChanged:!1,origin:new Float32Array(3),originChanged:!1},this.vectors={position:new Float32Array(3),positionChanged:!1,rotation:new Float32Array(l),rotationChanged:!1,scale:new Float32Array(c),scaleChanged:!1},this._lastEulerVals=[0,0,0],this._lastEuler=!1,this.parent=t?t:null,this.breakPoint=!1,this.calculatingWorldMatrix=!1}return h(e,[{key:"reset",value:function(){this.parent=null,this.breakPoint=!1,this.calculatingWorldMatrix=!1}},{key:"setParent",value:function(e){this.parent=e}},{key:"getParent",value:function(){return this.parent}},{key:"setBreakPoint",value:function(){this.breakPoint=!0,this.calculatingWorldMatrix=!0}},{key:"setCalculateWorldMatrix",value:function(){this.calculatingWorldMatrix=!0}},{key:"isBreakPoint",value:function(){return this.breakPoint}},{key:"getLocalTransform",value:function(){return this.local}},{key:"getWorldTransform",value:function(){if(!this.isBreakPoint()&&!this.calculatingWorldMatrix)throw new Error("This transform is not calculating world transforms");return this.global}},{key:"calculate",value:function(e){return!this.parent||this.parent.isBreakPoint()?r(e,this):o(e,this)}},{key:"getPosition",value:function(){return this.vectors.position}},{key:"setPosition",value:function(e,t,n){this.vectors.positionChanged=u(this.vectors.position,e,t,n)}},{key:"getRotation",value:function(){return this.vectors.rotation}},{key:"setRotation",value:function(e,t,n,i){var r,o,s,a,h=this.vectors.rotation;if(null!=i)r=e,o=t,s=n,a=i,this._lastEulerVals[0]=null,this._lastEulerVals[1]=null,this._lastEulerVals[2]=null,this._lastEuler=!1;else{if(null==e||null==t||null==n)if(this._lastEuler)e=null==e?this._lastEulerVals[0]:e,t=null==t?this._lastEulerVals[1]:t,n=null==n?this._lastEulerVals[2]:n;else{var l=-2*(h[1]*h[2]-h[3]*h[0]);Math.abs(l)>.99999?(t=null==t?.5*Math.PI*l:t,e=null==e?Math.atan2(-h[0]*h[2]+h[3]*h[1],.5-h[1]*h[1]-h[2]*h[2]):e,n=null==n?0:n):(t=null==t?Math.asin(l):t,e=null==e?Math.atan2(h[0]*h[2]+h[3]*h[1],.5-h[0]*h[0]-h[1]*h[1]):e,n=null==n?Math.atan2(h[0]*h[1]+h[3]*h[2],.5-h[0]*h[0]-h[2]*h[2]):n)}var c=.5*e,f=.5*t,d=.5*n,p=Math.sin(c),m=Math.sin(f),_=Math.sin(d),g=Math.cos(c),v=Math.cos(f),y=Math.cos(d),b=m*_,E=v*_,T=m*y,O=v*y;r=p*O+g*b,o=g*T-p*E,s=g*E+p*T,a=g*O-p*b,this._lastEuler=!0,this._lastEulerVals[0]=e,this._lastEulerVals[1]=t,this._lastEulerVals[2]=n}this.vectors.rotationChanged=u(h,r,o,s,a)}},{key:"getScale",value:function(){return this.vectors.scale}},{key:"setScale",value:function(e,t,n){this.vectors.scaleChanged=u(this.vectors.scale,e,t,n)}},{key:"getAlign",value:function(){return this.offsets.align}},{key:"setAlign",value:function(e,t,n){this.offsets.alignChanged=u(this.offsets.align,e,t,null!=n?n-.5:n)}},{key:"getMountPoint",value:function(){return this.offsets.mountPoint}},{key:"setMountPoint",value:function(e,t,n){this.offsets.mountPointChanged=u(this.offsets.mountPoint,e,t,null!=n?n-.5:n)}},{key:"getOrigin",value:function(){return this.offsets.origin}},{key:"setOrigin",value:function(e,t,n){this.offsets.originChanged=u(this.offsets.origin,e,t,null!=n?n-.5:n)}},{key:"calculateWorldMatrix",value:function(){for(var e=this.parent;e&&!e.isBreakPoint();)e=e.parent;if(e)return s(this.global,e.getWorldTransform(),this.local);for(var t=0;16>t;t++)this.global[t]=this.local[t];return!1}}]),e}();f.IDENT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f.WORLD_CHANGED=1,f.LOCAL_CHANGED=2,n.Transform=f},{}],17:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n){var i=n.align[0],r=n.align[1],o=n.align[2];e.onAlignChange&&e.onAlignChange(i,r,o);for(var s=0,a=t.length;a>s;s++)t[s]&&t[s].onAlignChange&&t[s].onAlignChange(i,r,o);n.alignChanged=!1}function o(e,t,n){var i=n.mountPoint[0],r=n.mountPoint[1],o=n.mountPoint[2];e.onMountPointChange&&e.onMountPointChange(i,r,o);for(var s=0,a=t.length;a>s;s++)t[s]&&t[s].onMountPointChange&&t[s].onMountPointChange(i,r,o);n.mountPointChanged=!1}function s(e,t,n){var i=n.origin[0],r=n.origin[1],o=n.origin[2];e.onOriginChange&&e.onOriginChange(i,r,o);for(var s=0,a=t.length;a>s;s++)t[s]&&t[s].onOriginChange&&t[s].onOriginChange(i,r,o);n.originChanged=!1}function a(e,t,n){var i=n.position[0],r=n.position[1],o=n.position[2];e.onPositionChange&&e.onPositionChange(i,r,o);for(var s=0,a=t.length;a>s;s++)t[s]&&t[s].onPositionChange&&t[s].onPositionChange(i,r,o);n.positionChanged=!1}function u(e,t,n){var i=n.rotation[0],r=n.rotation[1],o=n.rotation[2],s=n.rotation[3];e.onRotationChange&&e.onRotationChange(i,r,o,s);for(var a=0,u=t.length;u>a;a++)t[a]&&t[a].onRotationChange&&t[a].onRotationChange(i,r,o,s);n.rotationChanged=!1}function h(e,t,n){var i=n.scale[0],r=n.scale[1],o=n.scale[2];e.onScaleChange&&e.onScaleChange(i,r,o);for(var s=0,a=t.length;a>s;s++)t[s]&&t[s].onScaleChange&&t[s].onScaleChange(i,r,o);n.scaleChanged=!1}function l(e,t,n){e.onTransformChange&&e.onTransformChange(n);for(var i=0,r=t.length;r>i;i++)t[i]&&t[i].onTransformChange&&t[i].onTransformChange(n)}function c(e,t,n){e.onLocalTransformChange&&e.onLocalTransformChange(n);for(var i=0,r=t.length;r>i;i++)t[i]&&t[i].onLocalTransformChange&&t[i].onLocalTransformChange(n)}function f(e,t,n){e.onWorldTransformChange&&e.onWorldTransformChange(n);for(var i=0,r=t.length;r>i;i++)t[i]&&t[i].onWorldTransformChange&&t[i].onWorldTransformChange(n)}Object.defineProperty(n,"__esModule",{value:!0});var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=e("./Path"),m=e("./Transform"),_=e("./Dispatch"),g=e("./PathStore"),v=function(){function e(){i(this,e),this.pathStore=new g.PathStore}return d(e,[{key:"registerTransformAtPath",value:function(e,t){if(!p.Path.depth(e))return this.pathStore.insert(e,t?t:new m.Transform);var n=this.pathStore.get(p.Path.parent(e));if(!n)throw new Error("No parent transform registered at expected path: "+p.Path.parent(e));t&&t.setParent(n),this.pathStore.insert(e,t?t:new m.Transform(n))}},{key:"deregisterTransformAtPath",value:function(e){this.pathStore.remove(e)}},{key:"makeBreakPointAt",value:function(e){var t=this.pathStore.get(e);if(!t)throw new Error("No transform Registered at path: "+e);t.setBreakPoint()}},{key:"makeCalculateWorldMatrixAt",value:function(e){var t=this.pathStore.get(e);if(!t)throw new Error("No transform Registered at path: "+e);t.setCalculateWorldMatrix()}},{key:"get",value:function(e){return this.pathStore.get(e)}},{key:"update",value:function(){for(var e,t,n,i,d,p,g=this.pathStore.getItems(),v=this.pathStore.getPaths(),y=0,b=g.length;b>y;y++)n=_.Dispatch.getNode(v[y]),n&&(p=n.getComponents(),e=g[y],i=e.vectors,d=e.offsets,d.alignChanged&&r(n,p,d),d.mountPointChanged&&o(n,p,d),d.originChanged&&s(n,p,d),i.positionChanged&&a(n,p,i),i.rotationChanged&&u(n,p,i),i.scaleChanged&&h(n,p,i),(t=e.calculate(n))&&(l(n,p,e),t&m.Transform.LOCAL_CHANGED&&c(n,p,e.getLocalTransform()),t&m.Transform.WORLD_CHANGED&&f(n,p,e.getWorldTransform())))}}]),e}(),y=new v;n.TransformSystem=y},{"./Dispatch":5,"./Path":11,"./PathStore":12,"./Transform":16}],18:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("../utilities/CallbackStore"),s=e("../core/TransformSystem"),a=e("../core/OpacitySystem"),u=e("../core/Commands"),h=e("../core/Size"),l=function(){function e(t,n){if(i(this,e),!t)throw new Error("DOMElement must be instantiated on a node");if(this._changeQueue=[],this._requestingUpdate=!1,this._renderSized=!1,
this._requestRenderSize=!1,this._UIEvents=t.getUIEvents().slice(0),this._classes=["famous-dom-element"],this._requestingEventListeners=[],this._styles={},this._attributes={},this._content="",this._tagName=n&&n.tagName?n.tagName:"div",this._renderSize=[0,0,0],this._node=t,t&&t.addComponent(this),this._callbacks=new o.CallbackStore,this.setProperty("display",t.isShown()?"block":"none"),n){var r,s;if(n.classes)for(r=0;r<n.classes.length;r++)this.addClass(n.classes[r]);if(n.attributes)for(s in n.attributes)this.setAttribute(s,n.attributes[s]);if(n.properties)for(s in n.properties)this.setProperty(s,n.properties[s]);n.id&&this.setId(n.id),n.content&&this.setContent(n.content),n.cutout===!1&&this.setCutoutState(n.cutout)}}return r(e,[{key:"getValue",value:function(){return{classes:this._classes,styles:this._styles,attributes:this._attributes,content:this._content,id:this._attributes.id,tagName:this._tagName}}},{key:"onUpdate",value:function(){var e=this._node,t=this._changeQueue,n=t.length;if(n&&e){for(e.sendDrawCommand(u.Commands.WITH),e.sendDrawCommand(e.getLocation());n--;)e.sendDrawCommand(t.shift());this._requestRenderSize&&(e.sendDrawCommand(u.Commands.DOM_RENDER_SIZE),e.sendDrawCommand(e.getLocation()),this._requestRenderSize=!1)}this._requestingUpdate=!1}},{key:"onMount",value:function(e,t){this._node=e,this._id=t,this._UIEvents=e.getUIEvents().slice(0),s.TransformSystem.makeBreakPointAt(e.getLocation()),this.onSizeModeChange.apply(this,e.getSizeMode()),a.OpacitySystem.makeBreakPointAt(e.getLocation()),this.draw(),this.setAttribute("data-fa-path",e.getLocation())}},{key:"onDismount",value:function(){this.setProperty("display","none"),this.setAttribute("data-fa-path",""),this.setCutoutState(!1),this.onUpdate(),this._initialized=!1}},{key:"onShow",value:function(){this.setProperty("display","block")}},{key:"onHide",value:function(){this.setProperty("display","none")}},{key:"setCutoutState",value:function(e){return this._initialized&&this._changeQueue.push(u.Commands.GL_CUTOUT_STATE,e),this._requestingUpdate||this._requestUpdate(),this}},{key:"onTransformChange",value:function(e){this._changeQueue.push(u.Commands.CHANGE_TRANSFORM),e=e.getLocalTransform();for(var t=0,n=e.length;n>t;t++)this._changeQueue.push(e[t]);this._requestingUpdate||this._requestUpdate()}},{key:"onSizeChange",value:function(e,t){var n=this._node.getSizeMode(),i=n[0]!==h.Size.RENDER,r=n[1]!==h.Size.RENDER;return this._initialized&&this._changeQueue.push(u.Commands.CHANGE_SIZE,i?e:i,r?t:r),this._requestingUpdate||this._requestUpdate(),this}},{key:"onOpacityChange",value:function(e){return e=e.getLocalOpacity(),this.setProperty("opacity",e)}},{key:"onAddUIEvent",value:function(e){return-1===this._UIEvents.indexOf(e)?(this._subscribe(e),this._UIEvents.push(e)):this._inDraw&&this._subscribe(e),this}},{key:"onRemoveUIEvent",value:function(e){var t=this._UIEvents.indexOf(e);return-1!==t?(this._unsubscribe(e),this._UIEvents.splice(t,1)):this._inDraw&&this._unsubscribe(e),this}},{key:"_subscribe",value:function(e){this._initialized&&this._changeQueue.push(u.Commands.SUBSCRIBE,e),this._requestingUpdate||this._requestUpdate()}},{key:"preventDefault",value:function(e){this._initialized&&this._changeQueue.push(u.Commands.PREVENT_DEFAULT,e),this._requestingUpdate||this._requestUpdate()}},{key:"allowDefault",value:function(e){this._initialized&&this._changeQueue.push(u.Commands.ALLOW_DEFAULT,e),this._requestingUpdate||this._requestUpdate()}},{key:"_unsubscribe",value:function(e){this._initialized&&this._changeQueue.push(u.Commands.UNSUBSCRIBE,e),this._requestingUpdate||this._requestUpdate()}},{key:"onSizeModeChange",value:function(e,t,n){(e===h.Size.RENDER||t===h.Size.RENDER||n===h.Size.RENDER)&&(this._renderSized=!0,this._requestRenderSize=!0);var i=this._node.getSize();this.onSizeChange(i[0],i[1])}},{key:"getRenderSize",value:function(){return this._renderSize}},{key:"_requestUpdate",value:function(){!this._requestingUpdate&&this._id&&(this._node.requestUpdate(this._id),this._requestingUpdate=!0)}},{key:"init",value:function(){this._changeQueue.push(u.Commands.INIT_DOM,this._tagName),this._initialized=!0,this.onTransformChange(s.TransformSystem.get(this._node.getLocation())),this.onOpacityChange(a.OpacitySystem.get(this._node.getLocation()));var e=this._node.getSize();this.onSizeChange(e[0],e[1]),this._requestingUpdate||this._requestUpdate()}},{key:"setId",value:function(e){return this.setAttribute("id",e),this}},{key:"addClass",value:function(e){return this._classes.indexOf(e)<0?(this._initialized&&this._changeQueue.push(u.Commands.ADD_CLASS,e),this._classes.push(e),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0),this):(this._inDraw&&(this._initialized&&this._changeQueue.push(u.Commands.ADD_CLASS,e),this._requestingUpdate||this._requestUpdate()),this)}},{key:"removeClass",value:function(e){var t=this._classes.indexOf(e);return 0>t?this:(this._changeQueue.push(u.Commands.REMOVE_CLASS,e),this._classes.splice(t,1),this._requestingUpdate||this._requestUpdate(),this)}},{key:"hasClass",value:function(e){return-1!==this._classes.indexOf(e)}},{key:"setAttribute",value:function(e,t){return(this._attributes[e]!==t||this._inDraw)&&(this._attributes[e]=t,this._initialized&&this._changeQueue.push(u.Commands.CHANGE_ATTRIBUTE,e,t),this._requestUpdate||this._requestUpdate()),this}},{key:"setProperty",value:function(e,t){return(this._styles[e]!==t||this._inDraw)&&(this._styles[e]=t,this._initialized&&this._changeQueue.push(u.Commands.CHANGE_PROPERTY,e,t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this}},{key:"setContent",value:function(e){return(this._content!==e||this._inDraw)&&(this._content=e,this._initialized&&this._changeQueue.push(u.Commands.CHANGE_CONTENT,e),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this}},{key:"on",value:function(e,t){return this._callbacks.on(e,t)}},{key:"onReceive",value:function(e,t){"resize"===e&&(this._renderSize[0]=t.val[0],this._renderSize[1]=t.val[1],this._requestingUpdate||this._requestUpdate()),this._callbacks.trigger(e,t)}},{key:"draw",value:function(){var e,t,n;for(this._inDraw=!0,this.init(),t=0,n=this._classes.length;n>t;t++)this.addClass(this._classes[t]);this._content&&this.setContent(this._content);for(e in this._styles)null!=this._styles[e]&&this.setProperty(e,this._styles[e]);for(e in this._attributes)null!=this._attributes[e]&&this.setAttribute(e,this._attributes[e]);for(t=0,n=this._UIEvents.length;n>t;t++)this.onAddUIEvent(this._UIEvents[t]);this._inDraw=!1}}]),e}();n.DOMElement=l},{"../core/Commands":4,"../core/OpacitySystem":10,"../core/Size":14,"../core/TransformSystem":17,"../utilities/CallbackStore":42}],19:[function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){for(var t=[],n=e.target;n!==document.body;)t.push(n),n=n.parentNode;return t}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=e("./ElementCache"),u=e("./Math"),h=i(u),l=e("../core/Path"),c=e("../utilities/vendorPrefix"),f=e("../utilities/CallbackStore"),d=e("./events/EventMap"),p=null,m=function(){function e(t,n,i){r(this,e);var o=this;t.classList.add("famous-dom-renderer"),p=p||c.vendorPrefix("transform"),this._compositor=i,this._target=null,this._parent=null,this._path=null,this._children=[],this._insertElCallbackStore=new f.CallbackStore,this._removeElCallbackStore=new f.CallbackStore,this._root=new a.ElementCache(t,n),this._boundTriggerEvent=function(e){return o._triggerEvent(e)},this._selector=n,this._elements={},this._elements[n]=this._root,this.perspectiveTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._VPtransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._lastEv=null}return s(e,[{key:"subscribe",value:function(e){this._assertTargetLoaded(),this._listen(e),this._target.subscribe[e]=!0}},{key:"preventDefault",value:function(e){this._assertTargetLoaded(),this._listen(e),this._target.preventDefault[e]=!0}},{key:"allowDefault",value:function(e){this._assertTargetLoaded(),this._listen(e),this._target.preventDefault[e]=!1}},{key:"_listen",value:function(e){if(this._assertTargetLoaded(),!this._target.listeners[e]&&!this._root.listeners[e]){var t=d.EventMap[e][1]?this._root:this._target;t.listeners[e]=this._boundTriggerEvent,t.element.addEventListener(e,this._boundTriggerEvent)}}},{key:"unsubscribe",value:function(e){this._assertTargetLoaded(),this._target.subscribe[e]=!1}},{key:"_triggerEvent",value:function(e){if(this._lastEv!==e)for(var t=e.path?e.path:o(e),n=0;n<t.length;n++)if(t[n].dataset){var i=t[n].dataset.faPath;if(i&&(this._elements[i].preventDefault[e.type]&&e.preventDefault(),this._elements[i]&&this._elements[i].subscribe[e.type])){this._lastEv=e;var r=d.EventMap[e.type][0];this._compositor.sendEvent(i,e.type,new r(e));break}}}},{key:"getSizeOf",value:function(e){var t=this._elements[e];if(!t)return null;var n={val:t.size};return this._compositor.sendEvent(e,"resize",n),n}},{key:"draw",value:function(e){e.perspectiveDirty&&(this.perspectiveDirty=!0,this.perspectiveTransform[0]=e.perspectiveTransform[0],this.perspectiveTransform[1]=e.perspectiveTransform[1],this.perspectiveTransform[2]=e.perspectiveTransform[2],this.perspectiveTransform[3]=e.perspectiveTransform[3],this.perspectiveTransform[4]=e.perspectiveTransform[4],this.perspectiveTransform[5]=e.perspectiveTransform[5],this.perspectiveTransform[6]=e.perspectiveTransform[6],this.perspectiveTransform[7]=e.perspectiveTransform[7],this.perspectiveTransform[8]=e.perspectiveTransform[8],this.perspectiveTransform[9]=e.perspectiveTransform[9],this.perspectiveTransform[10]=e.perspectiveTransform[10],this.perspectiveTransform[11]=e.perspectiveTransform[11],this.perspectiveTransform[12]=e.perspectiveTransform[12],this.perspectiveTransform[13]=e.perspectiveTransform[13],this.perspectiveTransform[14]=e.perspectiveTransform[14],this.perspectiveTransform[15]=e.perspectiveTransform[15]),(e.viewDirty||e.perspectiveDirty)&&(h.multiply(this._VPtransform,this.perspectiveTransform,e.viewTransform),this._root.element.style[p]=this._stringifyMatrix(this._VPtransform))}},{key:"_assertPathLoaded",value:function(){if(!this._path)throw new Error("path not loaded")}},{key:"_assertParentLoaded",value:function(){if(!this._parent)throw new Error("parent not loaded")}},{key:"_assertChildrenLoaded",value:function(){if(!this._children)throw new Error("children not loaded")}},{key:"_assertTargetLoaded",value:function(){if(!this._target)throw new Error("No target loaded")}},{key:"findParent",value:function(){this._assertPathLoaded();for(var e,t=this._path;!e&&t.length;)t=t.substring(0,t.lastIndexOf("/")),e=this._elements[t];return this._parent=e,e}},{key:"findTarget",value:function(){return this._target=this._elements[this._path],this._target}},{key:"loadPath",value:function(e){return this._path=e,this._target=this._elements[this._path],this._path}},{key:"resolveChildren",value:function(e,t){for(var n,i,r=0,o=this._path;n=t.childNodes[r];)n.dataset?(i=n.dataset.faPath,i&&l.Path.isDescendentOf(i,o)?e.appendChild(n):r++):r++}},{key:"insertEl",value:function(e){if(this.findParent(),this._assertParentLoaded(),this._parent["void"])throw new Error(this._parent.path+" is a void element. Void elements are not allowed to have children.");this._target||(this._target=new a.ElementCache(document.createElement(e),this._path));var t=this._target.element,n=this._parent.element;this.resolveChildren(t,n),n.appendChild(t),this._elements[this._path]=this._target,this._insertElCallbackStore.trigger(this._path,this._target)}},{key:"setProperty",value:function(e,t){this._assertTargetLoaded(),this._target.element.style[e]=t}},{key:"setSize",value:function(e,t){this._assertTargetLoaded(),this.setWidth(e),this.setHeight(t)}},{key:"setWidth",value:function(e){this._assertTargetLoaded();var t=this._target.content;e===!1?(this._target.explicitWidth=!0,t&&(t.style.width=""),e=t?t.offsetWidth:0,this._target.element.style.width=e+"px"):(this._target.explicitWidth=!1,t&&(t.style.width=e+"px"),this._target.element.style.width=e+"px"),this._target.size[0]=e}},{key:"setHeight",value:function(e){this._assertTargetLoaded();var t=this._target.content;e===!1?(this._target.explicitHeight=!0,t&&(t.style.height=""),e=t?t.offsetHeight:0,this._target.element.style.height=e+"px"):(this._target.explicitHeight=!1,t&&(t.style.height=e+"px"),this._target.element.style.height=e+"px"),this._target.size[1]=e}},{key:"setAttribute",value:function(e,t){this._assertTargetLoaded(),this._target.element.setAttribute(e,t)}},{key:"setContent",value:function(e){this._assertTargetLoaded(),this._target.formElement?this._target.element.value=e:(this._target.content||(this._target.content=document.createElement("div"),this._target.content.classList.add("famous-dom-element-content"),this._target.element.insertBefore(this._target.content,this._target.element.firstChild)),this._target.content.innerHTML=e),this.setSize(this._target.explicitWidth?!1:this._target.size[0],this._target.explicitHeight?!1:this._target.size[1])}},{key:"setMatrix",value:function(e){this._assertTargetLoaded(),this._target.element.style[p]=this._stringifyMatrix(e)}},{key:"addClass",value:function(e){this._assertTargetLoaded(),this._target.element.classList.add(e)}},{key:"removeClass",value:function(e){this._assertTargetLoaded(),this._target.element.classList.remove(e)}},{key:"_stringifyMatrix",value:function(e){var t="matrix3d(";return t+=e[0]<1e-6&&e[0]>-1e-6?"0,":e[0]+",",t+=e[1]<1e-6&&e[1]>-1e-6?"0,":e[1]+",",t+=e[2]<1e-6&&e[2]>-1e-6?"0,":e[2]+",",t+=e[3]<1e-6&&e[3]>-1e-6?"0,":e[3]+",",t+=e[4]<1e-6&&e[4]>-1e-6?"0,":e[4]+",",t+=e[5]<1e-6&&e[5]>-1e-6?"0,":e[5]+",",t+=e[6]<1e-6&&e[6]>-1e-6?"0,":e[6]+",",t+=e[7]<1e-6&&e[7]>-1e-6?"0,":e[7]+",",t+=e[8]<1e-6&&e[8]>-1e-6?"0,":e[8]+",",t+=e[9]<1e-6&&e[9]>-1e-6?"0,":e[9]+",",t+=e[10]<1e-6&&e[10]>-1e-6?"0,":e[10]+",",t+=e[11]<1e-6&&e[11]>-1e-6?"0,":e[11]+",",t+=e[12]<1e-6&&e[12]>-1e-6?"0,":e[12]+",",t+=e[13]<1e-6&&e[13]>-1e-6?"0,":e[13]+",",t+=e[14]<1e-6&&e[14]>-1e-6?"0,":e[14]+",",t+=e[15]+")"}},{key:"onInsertEl",value:function(e,t){return this._insertElCallbackStore.on(e,t),this}},{key:"offInsertEl",value:function(e,t){return this._insertElCallbackStore.off(e,t),this}},{key:"onRemoveEl",value:function(e,t){return this._removeElCallbackStore.on(e,t),this}},{key:"offRemoveEl",value:function(e,t){return this._removeElCallbackStore.off(e,t),this}}]),e}();n.DOMRenderer=m},{"../core/Path":11,"../utilities/CallbackStore":42,"../utilities/vendorPrefix":46,"./ElementCache":20,"./Math":21,"./events/EventMap":25}],20:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./VoidElements"),o=function s(e,t){i(this,s),this.tagName=e.tagName.toLowerCase(),this["void"]=r.VoidElements[this.tagName];var n=e.constructor;this.formElement=n===HTMLInputElement||n===HTMLTextAreaElement||n===HTMLSelectElement,this.element=e,this.path=t,this.content=null,this.size=new Int16Array(3),this.explicitHeight=!1,this.explicitWidth=!1,this.postRenderSize=new Float32Array(2),this.listeners={},this.preventDefault={},this.subscribe={}};n.ElementCache=o},{"./VoidElements":22}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],u=t[6],h=t[7],l=t[8],c=t[9],f=t[10],d=t[11],p=t[12],m=t[13],_=t[14],g=t[15],v=n*a-i*s,y=n*u-r*s,b=n*h-o*s,E=i*u-r*a,T=i*h-o*a,O=r*h-o*u,C=l*m-c*p,S=l*_-f*p,w=l*g-d*p,R=c*_-f*m,A=c*g-d*m,I=f*g-d*_,k=v*I-y*A+b*R+E*w-T*S+O*C;return k?(k=1/k,e[0]=(a*I-u*A+h*R)*k,e[1]=(r*A-i*I-o*R)*k,e[2]=(m*O-_*T+g*E)*k,e[3]=(f*T-c*O-d*E)*k,e[4]=(u*w-s*I-h*S)*k,e[5]=(n*I-r*w+o*S)*k,e[6]=(_*b-p*O-g*y)*k,e[7]=(l*O-f*b+d*y)*k,e[8]=(s*A-a*w+h*C)*k,e[9]=(i*w-n*A-o*C)*k,e[10]=(p*T-m*b+g*v)*k,e[11]=(c*b-l*T-d*v)*k,e[12]=(a*S-s*R-u*C)*k,e[13]=(n*R-i*S+r*C)*k,e[14]=(m*y-p*E-_*v)*k,e[15]=(l*E-c*y+f*v)*k,e):null},r=function(e,t,n){var i,r,o,s,a=t[0],u=t[1],h=t[2],l=t[3],c=t[4],f=t[5],d=t[6],p=t[7],m=t[8],_=t[9],g=t[10],v=t[11],y=t[12],b=t[13],E=t[14],T=t[15],O=n[0],C=n[1],S=n[2],w=n[3],R=n[4],A=n[5],I=n[6],k=n[7],N=n[8],P=n[9],L=n[10],M=n[11],D=n[12],U=n[13],x=n[14],F=n[15],z=!1;return i=O*a+C*c+S*m+w*y,r=O*u+C*f+S*_+w*b,o=O*h+C*d+S*g+w*E,s=O*l+C*p+S*v+w*T,z=z?z:i===e[0]||r===e[1]||o===e[2]||s===e[3],e[0]=i,e[1]=r,e[2]=o,e[3]=s,O=R,C=A,S=I,w=k,i=O*a+C*c+S*m+w*y,r=O*u+C*f+S*_+w*b,o=O*h+C*d+S*g+w*E,s=O*l+C*p+S*v+w*T,z=z?z:i===e[4]||r===e[5]||o===e[6]||s===e[7],e[4]=i,e[5]=r,e[6]=o,e[7]=s,O=N,C=P,S=L,w=M,i=O*a+C*c+S*m+w*y,r=O*u+C*f+S*_+w*b,o=O*h+C*d+S*g+w*E,s=O*l+C*p+S*v+w*T,z=z?z:i===e[8]||r===e[9]||o===e[10]||s===e[11],e[8]=i,e[9]=r,e[10]=o,e[11]=s,O=D,C=U,S=x,w=F,i=O*a+C*c+S*m+w*y,r=O*u+C*f+S*_+w*b,o=O*h+C*d+S*g+w*E,s=O*l+C*p+S*v+w*T,z=z?z:i===e[12]||r===e[13]||o===e[14]||s===e[15],e[12]=i,e[13]=r,e[14]=o,e[15]=s,e};n.invert=i,n.multiply=r},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};n.VoidElements=i},{}],23:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./UIEvent"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.data=e.data}return r(t,e),o(t,[{key:"toString",value:function(){return"CompositionEvent"}}]),t}(a.UIEvent);n.CompositionEvent=u},{"./UIEvent":31}],24:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.timeStamp=t.timeStamp;var n=t.target.constructor;(n===HTMLInputElement||n===HTMLTextAreaElement||n===HTMLSelectElement)&&(this.value=t.target.value)}return r(e,[{key:"toString",value:function(){return"Event"}}]),e}();n.Event=o},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./CompositionEvent"),r=e("./Event"),o=e("./FocusEvent"),s=e("./InputEvent"),a=e("./KeyboardEvent"),u=e("./MouseEvent"),h=e("./TouchEvent"),l=e("./UIEvent"),c=e("./WheelEvent"),f={change:[r.Event,!0],submit:[r.Event,!0],abort:[r.Event,!1],beforeinput:[s.InputEvent,!0],blur:[o.FocusEvent,!1],click:[u.MouseEvent,!0],compositionend:[i.CompositionEvent,!0],compositionstart:[i.CompositionEvent,!0],compositionupdate:[i.CompositionEvent,!0],dblclick:[u.MouseEvent,!0],focus:[o.FocusEvent,!1],focusin:[o.FocusEvent,!0],focusout:[o.FocusEvent,!0],input:[s.InputEvent,!0],keydown:[a.KeyboardEvent,!0],keyup:[a.KeyboardEvent,!0],load:[r.Event,!1],mousedown:[u.MouseEvent,!0],mouseenter:[u.MouseEvent,!1],mouseleave:[u.MouseEvent,!1],mousemove:[u.MouseEvent,!1],mouseout:[u.MouseEvent,!0],mouseover:[u.MouseEvent,!0],mouseup:[u.MouseEvent,!0],contextMenu:[u.MouseEvent,!0],resize:[l.UIEvent,!1],scroll:[l.UIEvent,!1],select:[r.Event,!0],unload:[r.Event,!1],wheel:[c.WheelEvent,!0],touchcancel:[h.TouchEvent,!0],touchend:[h.TouchEvent,!0],touchmove:[h.TouchEvent,!0],touchstart:[h.TouchEvent,!0]};n.EventMap=f},{"./CompositionEvent":23,"./Event":24,"./FocusEvent":26,"./InputEvent":27,"./KeyboardEvent":28,"./MouseEvent":29,"./TouchEvent":30,"./UIEvent":31,"./WheelEvent":32}],26:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./UIEvent"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return r(t,e),o(t,[{key:"toString",value:function(){return"FocusEvent"}}]),t}(a.UIEvent);n.FocusEvent=u},{"./UIEvent":31}],27:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./UIEvent"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.inputType=e.inputType,this.data=e.data,this.isComposing=e.isComposing,this.targetRange=e.targetRange}return r(t,e),o(t,[{key:"toString",value:function(){return"InputEvent"}}]),t}(a.UIEvent);n.InputEvent=u},{"./UIEvent":31}],28:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./UIEvent"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.DOM_KEY_LOCATION_STANDARD=0,this.DOM_KEY_LOCATION_LEFT=1,this.DOM_KEY_LOCATION_RIGHT=2,this.DOM_KEY_LOCATION_NUMPAD=3,this.key=e.key,this.code=e.code,this.location=e.location,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.repeat=e.repeat,this.isComposing=e.isComposing,this.keyCode=e.keyCode}return r(t,e),o(t,[{key:"toString",value:function(){return"KeyboardEvent"}}]),t}(a.UIEvent);n.KeyboardEvent=u},{"./UIEvent":31}],29:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./UIEvent"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.screenX=e.screenX,this.screenY=e.screenY,this.clientX=e.clientX,this.clientY=e.clientY,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.button=e.button,this.buttons=e.buttons,this.pageX=e.pageX,this.pageY=e.pageY,this.x=e.x,this.y=e.y,this.offsetX=e.offsetX,this.offsetY=e.offsetY}return r(t,e),o(t,[{key:"toString",value:function(){return"MouseEvent"}}]),t}(a.UIEvent);n.MouseEvent=u},{"./UIEvent":31}],30:[function(e,t,n){"use strict";function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){if(!e)return h;for(var t=[],n=0;n<e.length;n++)t[n]=new l(e[n]);return t}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},u=e("./UIEvent"),h=[],l=function f(e){r(this,f),this.identifier=e.identifier,this.screenX=e.screenX,this.screenY=e.screenY,this.clientX=e.clientX,this.clientY=e.clientY,this.pageX=e.pageX,this.pageY=e.pageY},c=function(e){function t(e){r(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.touches=o(e.touches),this.targetTouches=o(e.targetTouches),this.changedTouches=o(e.changedTouches),this.altKey=e.altKey,this.metaKey=e.metaKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey}return i(t,e),s(t,[{key:"toString",value:function(){return"TouchEvent"}}]),t}(u.UIEvent);n.TouchEvent=c},{"./UIEvent":31}],31:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./Event"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.detail=e.detail}return r(t,e),o(t,[{key:"toString",value:function(){return"UIEvent"}}]),t}(a.Event);n.UIEvent=u},{"./Event":24}],32:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("./MouseEvent"),u=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2,this.deltaX=e.deltaX,this.deltaY=e.deltaY,this.deltaZ=e.deltaZ,this.deltaMode=e.deltaMode}return r(t,e),o(t,[{key:"toString",value:function(){return"WheelEvent"}}]),t}(a.MouseEvent);n.WheelEvent=u},{"./MouseEvent":29}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r,o=0,s=["ms","moz","webkit","o"];if("object"==typeof window){i=window.requestAnimationFrame,r=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(var a=0;a<s.length&&!i;++a)i=window[s[a]+"RequestAnimationFrame"],r=window[s[a]+"CancelRequestAnimationFrame"]||window[s[a]+"CancelAnimationFrame"];
i&&!r&&(i=null)}if(!i){var u=Date.now?Date.now:function(){return(new Date).getTime()};i=function(e){var t=u(),n=Math.max(0,16-(t-o)),i=setTimeout(function(){e(t+n)},n);return o=t+n,i},r=function(e){clearTimeout(e)}}var h=i,l=r;n.requestAnimationFrame=h,n.cancelAnimationFrame=l},{}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./animationFrame");n.requestAnimationFrame=i.requestAnimationFrame,n.cancelAnimationFrame=i.cancelAnimationFrame},{"./animationFrame":33}],35:[function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=e("../polyfills"),a=i(s),u=a.requestAnimationFrame,h=a.cancelAnimationFrame,l="undefined"!=typeof document;if(l){var c,f;"undefined"!=typeof document.hidden?(c="hidden",f="visibilitychange"):"undefined"!=typeof document.mozHidden?(c="mozHidden",f="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(c="msHidden",f="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(c="webkitHidden",f="webkitvisibilitychange")}var d=function(){function e(){r(this,e);var t=this;this._updates=[],this._looper=function(e){t.loop(e)},this._time=0,this._stoppedAt=0,this._sleep=0,this._startOnVisibilityChange=!0,this._rAF=null,this._sleepDiff=!0,this.start(),l&&document.addEventListener(f,function(){t._onVisibilityChange()})}return o(e,[{key:"_onVisibilityChange",value:function(){document[c]?this._onUnfocus():this._onFocus()}},{key:"_onFocus",value:function(){this._startOnVisibilityChange&&this._start()}},{key:"_onUnfocus",value:function(){this._stop()}},{key:"start",value:function(){return this._running||(this._startOnVisibilityChange=!0,this._start()),this}},{key:"_start",value:function(){this._running=!0,this._sleepDiff=!0,this._rAF=u(this._looper)}},{key:"stop",value:function(){return this._running&&(this._startOnVisibilityChange=!1,this._stop()),this}},{key:"_stop",value:function(){this._running=!1,this._stoppedAt=this._time,h(this._rAF)}},{key:"isRunning",value:function(){return this._running}},{key:"step",value:function(e){this._time=e,this._sleepDiff&&(this._sleep+=e-this._stoppedAt,this._sleepDiff=!1);for(var t=e-this._sleep,n=0,i=this._updates.length;i>n;n++)this._updates[n].update(t);return this}},{key:"loop",value:function(e){return this.step(e),this._rAF=u(this._looper),this}},{key:"update",value:function(e){return-1===this._updates.indexOf(e)&&this._updates.push(e),this}},{key:"noLongerUpdate",value:function(e){var t=this._updates.indexOf(e);return t>-1&&this._updates.splice(t,1),this}}]),e}();n.RequestAnimationFrameLoop=d},{"../polyfills":34}],36:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./Context"),s=e("./inject-css"),a=e("../core/Commands"),u=function(){function e(){i(this,e),s.injectCSS(),this._contexts={},this._outCommands=[],this._inCommands=[],this._time=null,this._resized=!1;var t=this;window.addEventListener("resize",function(){t.onResize()})}return r(e,[{key:"onResize",value:function(){this._resized=!0;for(var e in this._contexts)this._contexts[e].updateSize()}},{key:"getTime",value:function(){return this._time}},{key:"sendEvent",value:function(e,t,n){this._outCommands.push(a.Commands.WITH,e,a.Commands.TRIGGER,t,n)}},{key:"sendResize",value:function(e,t){this.sendEvent(e,"CONTEXT_RESIZE",t)}},{key:"handleWith",value:function(e,t){var n=t[e],i=n.split("/"),r=this.getOrSetContext(i.shift());return r.receive(n,t,e)}},{key:"getOrSetContext",value:function(e){if(this._contexts[e])return this._contexts[e];var t=new o.Context(e,this);return this._contexts[e]=t,t}},{key:"getContext",value:function(e){return this._contexts[e]?this._contexts[e]:void 0}},{key:"drawCommands",value:function(){for(var e=this._inCommands,t=0,n=e[t];n;){switch(n){case a.Commands.TIME:this._time=e[++t];break;case a.Commands.WITH:t=this.handleWith(++t,e);break;case a.Commands.NEED_SIZE_FOR:this.giveSizeFor(++t,e)}n=e[++t]}for(var i in this._contexts)this._contexts[i].draw();return this._resized&&this.updateSize(),this._outCommands}},{key:"updateSize",value:function(){for(var e in this._contexts)this._contexts[e].updateSize()}},{key:"receiveCommands",value:function(e){for(var t=e.length,n=0;t>n;n++)this._inCommands.push(e[n]);for(var i in this._contexts)this._contexts[i].checkInit()}},{key:"giveSizeFor",value:function(e,t){var n=t[e],i=this.getContext(n);if(i){var r=i.getRootSize();this.sendResize(n,r)}else this.getOrSetContext(n)}},{key:"clearCommands",value:function(){this._inCommands.length=0,this._outCommands.length=0,this._resized=!1}}]),e}();n.Compositor=u},{"../core/Commands":4,"./Context":37,"./inject-css":39}],37:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.preventDefault(n[++i]),i}function o(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.allowDefault(n[++i]),i}function s(e,t,n,i){return e._initDOM=!0,i}function a(e,t,n,i){return e._domRenderer.insertEl(n[++i]),i}function u(e,t,n,i){return e._domRenderer.getSizeOf(n[++i]),i}function h(e,t,n,i){var r=e._meshTransform;return r[0]=n[++i],r[1]=n[++i],r[2]=n[++i],r[3]=n[++i],r[4]=n[++i],r[5]=n[++i],r[6]=n[++i],r[7]=n[++i],r[8]=n[++i],r[9]=n[++i],r[10]=n[++i],r[11]=n[++i],r[12]=n[++i],r[13]=n[++i],r[14]=n[++i],r[15]=n[++i],e._domRenderer.setMatrix(r),e._webGLRenderer&&e._webGLRenderer.setCutoutUniform(t,"u_transform",r),i}function l(e,t,n,i){var r=n[++i],o=n[++i];return e._domRenderer.setSize(r,o),e._webGLRenderer&&(e._meshSize[0]=r,e._meshSize[1]=o,e._webGLRenderer.setCutoutUniform(t,"u_size",e._meshSize)),i}function c(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.setProperty(n[++i],n[++i]),i}function f(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.setContent(n[++i]),i}function d(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.setAttribute(n[++i],n[++i]),i}function p(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.addClass(n[++i]),i}function m(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.removeClass(n[++i]),i}function _(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.subscribe(n[++i]),i}function g(e,t,n,i){return e._webGLRenderer&&e._webGLRenderer.getOrSetCutout(t),e._domRenderer.unsubscribe(n[++i]),i}function v(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setMeshOptions(t,n[++i]),i}function y(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setAmbientLightColor(t,n[++i],n[++i],n[++i]),i}function b(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setLightPosition(t,n[++i],n[++i],n[++i]),i}function E(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setLightColor(t,n[++i],n[++i],n[++i]),i}function T(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.handleMaterialInput(t,n[++i],n[++i]),i}function O(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setGeometry(t,n[++i],n[++i],n[++i]),i}function C(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setMeshUniform(t,n[++i],n[++i]),i}function S(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.bufferData(n[++i],n[++i],n[++i],n[++i],n[++i]),i}function w(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setCutoutState(t,n[++i]),i}function R(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.setMeshVisibility(t,n[++i]),i}function A(e,t,n,i){return e._webGLRenderer||e._initWebGLRenderer(),e._webGLRenderer.removeMesh(t),i}function I(e,t,n,i){return e._renderState.projectionType=M.Camera.PINHOLE_PROJECTION,e._renderState.perspectiveTransform[11]=-1/n[++i],e._renderState.perspectiveDirty=!0,i}function k(e,t,n,i){return e._renderState.projectionType=M.Camera.ORTHOGRAPHIC_PROJECTION,e._renderState.perspectiveTransform[11]=0,e._renderState.perspectiveDirty=!0,i}function N(e,t,n,i){return e._renderState.viewTransform[0]=n[++i],e._renderState.viewTransform[1]=n[++i],e._renderState.viewTransform[2]=n[++i],e._renderState.viewTransform[3]=n[++i],e._renderState.viewTransform[4]=n[++i],e._renderState.viewTransform[5]=n[++i],e._renderState.viewTransform[6]=n[++i],e._renderState.viewTransform[7]=n[++i],e._renderState.viewTransform[8]=n[++i],e._renderState.viewTransform[9]=n[++i],e._renderState.viewTransform[10]=n[++i],e._renderState.viewTransform[11]=n[++i],e._renderState.viewTransform[12]=n[++i],e._renderState.viewTransform[13]=n[++i],e._renderState.viewTransform[14]=n[++i],e._renderState.viewTransform[15]=n[++i],e._renderState.viewDirty=!0,i}Object.defineProperty(n,"__esModule",{value:!0});var P=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),L=e("../webgl-renderers/WebGLRenderer"),M=e("../components/Camera"),D=e("../dom-renderers/DOMRenderer"),U=e("../core/Commands"),x=function(){function e(t,n){if(i(this,e),this._compositor=n,this._rootEl=document.querySelector(t),this._selector=t,null===this._rootEl)throw new Error('Failed to create Context: No matches for "'+t+'" found.');this._selector=t,this._initDOMRenderer(),this._webGLRenderer=null,this._domRenderer=new D.DOMRenderer(this._domRendererRootEl,t,n),this._canvasEl=null,this._renderState={projectionType:M.Camera.ORTHOGRAPHIC_PROJECTION,perspectiveTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewDirty:!1,perspectiveDirty:!1},this._size=[],this._meshTransform=new Float32Array(16),this._meshSize=[0,0,0],this._initDOM=!1,this._commandCallbacks=[],this.initCommandCallbacks(),this.updateSize()}return P(e,[{key:"updateSize",value:function(){var e=this._rootEl.offsetWidth,t=this._rootEl.offsetHeight;return this._size[0]=e,this._size[1]=t,this._size[2]=e>t?e:t,this._compositor.sendResize(this._selector,this._size),this._webGLRenderer&&this._webGLRenderer.updateSize(this._size),this}},{key:"draw",value:function(){this._domRenderer.draw(this._renderState),this._webGLRenderer&&this._webGLRenderer.draw(this._renderState),this._renderState.perspectiveDirty&&(this._renderState.perspectiveDirty=!1),this._renderState.viewDirty&&(this._renderState.viewDirty=!1)}},{key:"_initDOMRenderer",value:function(){this._domRendererRootEl=document.createElement("div"),this._rootEl.appendChild(this._domRendererRootEl),this._domRendererRootEl.style.visibility="hidden",this._domRenderer=new D.DOMRenderer(this._domRendererRootEl,this._selector,this._compositor)}},{key:"initCommandCallbacks",value:function(){this._commandCallbacks[U.Commands.INIT_DOM]=a,this._commandCallbacks[U.Commands.DOM_RENDER_SIZE]=u,this._commandCallbacks[U.Commands.CHANGE_TRANSFORM]=h,this._commandCallbacks[U.Commands.CHANGE_SIZE]=l,this._commandCallbacks[U.Commands.CHANGE_PROPERTY]=c,this._commandCallbacks[U.Commands.CHANGE_CONTENT]=f,this._commandCallbacks[U.Commands.CHANGE_ATTRIBUTE]=d,this._commandCallbacks[U.Commands.ADD_CLASS]=p,this._commandCallbacks[U.Commands.REMOVE_CLASS]=m,this._commandCallbacks[U.Commands.SUBSCRIBE]=_,this._commandCallbacks[U.Commands.UNSUBSCRIBE]=g,this._commandCallbacks[U.Commands.GL_SET_DRAW_OPTIONS]=v,this._commandCallbacks[U.Commands.GL_AMBIENT_LIGHT]=y,this._commandCallbacks[U.Commands.GL_LIGHT_POSITION]=b,this._commandCallbacks[U.Commands.GL_LIGHT_COLOR]=E,this._commandCallbacks[U.Commands.MATERIAL_INPUT]=T,this._commandCallbacks[U.Commands.GL_SET_GEOMETRY]=O,this._commandCallbacks[U.Commands.GL_UNIFORMS]=C,this._commandCallbacks[U.Commands.GL_BUFFER_DATA]=S,this._commandCallbacks[U.Commands.GL_CUTOUT_STATE]=w,this._commandCallbacks[U.Commands.GL_MESH_VISIBILITY]=R,this._commandCallbacks[U.Commands.GL_REMOVE_MESH]=A,this._commandCallbacks[U.Commands.PINHOLE_PROJECTION]=I,this._commandCallbacks[U.Commands.ORTHOGRAPHIC_PROJECTION]=k,this._commandCallbacks[U.Commands.CHANGE_VIEW_TRANSFORM]=N,this._commandCallbacks[U.Commands.PREVENT_DEFAULT]=r,this._commandCallbacks[U.Commands.ALLOW_DEFAULT]=o,this._commandCallbacks[U.Commands.READY]=s}},{key:"_initWebGLRenderer",value:function(){this._webGLRendererRootEl=document.createElement("canvas"),this._rootEl.appendChild(this._webGLRendererRootEl),this._webGLRenderer=new L.WebGLRenderer(this._webGLRendererRootEl,this._compositor),this._webGLRenderer.updateSize(this._size)}},{key:"getRootSize",value:function(){return[this._rootEl.offsetWidth,this._rootEl.offsetHeight]}},{key:"checkInit",value:function(){this._initDOM&&(this._domRendererRootEl.style.visibility="visible",this._initDOM=!1)}},{key:"receive",value:function(e,t,n){var i=n,r=t[++i];for(this._domRenderer.loadPath(e);null!=r;){if(r===U.Commands.WITH||r===U.Commands.TIME)return i-1;i=this._commandCallbacks[r](this,e,t,i)+1,r=t[i]}return i}},{key:"getDOMRenderer",value:function(){return this._domRenderer}},{key:"getWebGLRenderer",value:function(){return this._webGLRenderer}}]),e}();n.Context=x},{"../components/Camera":1,"../core/Commands":4,"../dom-renderers/DOMRenderer":19,"../webgl-renderers/WebGLRenderer":53}],38:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("../core/Commands"),s=function(){function e(t,n,r){i(this,e),this._thread=t,this._compositor=n,this._renderLoop=r,this._renderLoop.update(this);var s=this;this._thread.onmessage=function(e){var t=e.data?e.data:e;if(t[0]===o.Commands.ENGINE)switch(t[1]){case o.Commands.START:s._engine.start();break;case o.Commands.STOP:s._engine.stop();break;default:console.error('Unknown ENGINE command "'+t[1]+'"')}else s._compositor.receiveCommands(t)},this._thread.onerror=function(e){console.error(e)}}return r(e,[{key:"getThread",value:function(){return this._thread}},{key:"getCompositor",value:function(){return this._compositor}},{key:"getEngine",value:function(){return this._renderLoop}},{key:"getRenderLoop",value:function(){return this._renderLoop}},{key:"update",value:function(e){this._thread.postMessage([o.Commands.FRAME,e]);var t=this._compositor.drawCommands();this._thread.postMessage(t),this._compositor.clearCommands()}}]),e}();n.UIManager=s},{"../core/Commands":4}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=".famous-dom-renderer {width:100%;height:100%;transform-style:preserve-3d;-webkit-transform-style:preserve-3d;}.famous-dom-element {-webkit-transform-origin:0% 0%;transform-origin:0% 0%;-webkit-backface-visibility:visible;backface-visibility:visible;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-tap-highlight-color:transparent;pointer-events:auto;z-index:1;}.famous-dom-element-content,.famous-dom-element {position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;}.famous-webgl-renderer {-webkit-transform:translateZ(1000000px);transform:translateZ(1000000px);pointer-events:none;position:absolute;z-index:1;top:0;width:100%;height:100%;}",r="undefined"==typeof document,o=function(){if(!r)if(r=!0,document.createStyleSheet){var e=document.createStyleSheet();e.cssText=i}else{var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i)),(t?t:document.documentElement).appendChild(n)}};n.injectCSS=o},{}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={linear:function(e){return e},easeIn:function(e){return e*e},easeOut:function(e){return e*(2-e)},easeInOut:function(e){return.5>=e?2*e*e:-2*e*e+4*e-1},easeOutBounce:function(e){return e*(3-2*e)},spring:function(e){return(1-e)*Math.sin(6*Math.PI*e)+e},inQuad:function(e){return e*e},outQuad:function(e){return-(e-=1)*e+1},inOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},inQuart:function(e){return e*e*e*e},outQuart:function(e){return-(--e*e*e*e-1)},inOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return--e*e*e*e*e+1},inOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},inSine:function(e){return-1*Math.cos(e*(Math.PI/2))+1},outSine:function(e){return Math.sin(e*(Math.PI/2))},inOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},inExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},outExpo:function(e){return 1===e?1:-Math.pow(2,-10*e)+1},inOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(-Math.pow(2,-10*--e)+2)},inCirc:function(e){return-(Math.sqrt(1-e*e)-1)},outCirc:function(e){return Math.sqrt(1- --e*e)},inOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},inElastic:function(e){var t=1.70158,n=0,i=1;return 0===e?0:1===e?1:(n||(n=.3),t=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},outElastic:function(e){var t=1.70158,n=0,i=1;return 0===e?0:1===e?1:(n||(n=.3),t=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},inOutElastic:function(e){var t=1.70158,n=0,i=1;return 0===e?0:2===(e/=.5)?1:(n||(n=.3*1.5),t=n/(2*Math.PI)*Math.asin(1/i),1>e?-.5*(i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},inBack:function(e,t){return void 0===t&&(t=1.70158),e*e*((t+1)*e-t)},outBack:function(e,t){return void 0===t&&(t=1.70158),--e*e*((t+1)*e+t)+1},inOutBack:function(e,t){return void 0===t&&(t=1.70158),(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},inBounce:function(e){return 1-i.outBounce(1-e)},outBounce:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},inOutBounce:function(e){return.5>e?.5*i.inBounce(2*e):.5*i.outBounce(2*e-1)+.5},flat:function(){return 0}};n.Curves=i},{}],41:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./Curves"),s=e("../core/FamousEngine"),a=function(){function e(t){i(this,e),this._queue=[],this._from=null,this._state=null,this._startedAt=null,this._pausedAt=null,null!=t&&this.from(t)}return r(e,[{key:"to",value:function(e,t,n,i,r){return t=null!=t&&t.constructor===String?o.Curves[t]:t,0===this._queue.length&&(this._startedAt=this.constructor.Clock.now(),this._pausedAt=null),this._queue.push(e,null!=t?t:o.Curves.linear,null!=n?n:100,i,r),this}},{key:"from",value:function(e){return this._state=e,this._from=this._sync(null,this._state),this._queue.length=0,this._startedAt=this.constructor.Clock.now(),this._pausedAt=null,this}},{key:"delay",value:function(e,t){var n=this._queue.length>0?this._queue[this._queue.length-5]:this._state;return this.to(n,o.Curves.flat,e,t)}},{key:"override",value:function(e,t,n,i,r){return this._queue.length>0&&(null!=e&&(this._queue[0]=e),null!=t&&(this._queue[1]=t.constructor===String?o.Curves[t]:t),null!=n&&(this._queue[2]=n),null!=i&&(this._queue[3]=i),null!=r&&(this._queue[4]=r)),this}},{key:"_interpolate",value:function(e,t,n,i,r){if(n instanceof Object)if("slerp"===r){var o,s,a,u,h,l,c,f,d,p,m,_,g;if(o=t[0],s=t[1],a=t[2],u=t[3],h=n[0],l=n[1],c=n[2],f=n[3],1===i)return e[0]=h,e[1]=l,e[2]=c,e[3]=f,e;p=u*f+o*h+s*l+a*c,1-p>1e-5?(d=Math.acos(p),m=Math.sin(d),_=Math.sin((1-i)*d)/m,g=Math.sin(i*d)/m):(_=1-i,g=i),e[0]=o*_+h*g,e[1]=s*_+l*g,e[2]=a*_+c*g,e[3]=u*_+f*g}else if(n instanceof Array)for(var v=0,y=n.length;y>v;v++)e[v]=this._interpolate(e[v],t[v],n[v],i,r);else for(var b in n)e[b]=this._interpolate(e[b],t[b],n[b],i,r);else e=t+i*(n-t);return e}},{key:"_sync",value:function(e,t){if("number"==typeof t)e=t;else if(t instanceof Array){null==e&&(e=[]);for(var n=0,i=t.length;i>n;n++)e[n]=this._sync(e[n],t[n])}else if(t instanceof Object){null==e&&(e={});for(var r in t)e[r]=this._sync(e[r],t[r])}return e}},{key:"get",value:function(e){if(0===this._queue.length)return this._state;e=this._pausedAt?this._pausedAt:e,e=e?e:this.constructor.Clock.now();var t=(e-this._startedAt)/this._queue[2];this._state=this._interpolate(this._state,this._from,this._queue[0],this._queue[1](t>1?1:t),this._queue[4]);var n=this._state;if(t>=1){this._startedAt=this._startedAt+this._queue[2],this._from=this._sync(this._from,this._state),this._queue.shift(),this._queue.shift(),this._queue.shift();var i=this._queue.shift();this._queue.shift(),i&&i()}return t>1?this.get():n}},{key:"isActive",value:function(){return this._queue.length>0}},{key:"halt",value:function(){return this.from(this.get())}},{key:"pause",value:function(){return this._pausedAt=this.constructor.Clock.now(),this}},{key:"isPaused",value:function(){return!!this._pausedAt}},{key:"resume",value:function(){var e=this._pausedAt-this._startedAt;return this._startedAt=this.constructor.Clock.now()-e,this._pausedAt=null,this}},{key:"reset",value:function(e){return this.from(e)}},{key:"set",value:function(e,t,n){return null==t?(this.from(e),n&&n()):this.to(e,t.curve,t.duration,n,t.method),this}}]),e}();a.Clock=s.FamousEngine.getClock(),n.Transitionable=a},{"../core/FamousEngine":7,"./Curves":40}],42:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e),this._events={}}return r(e,[{key:"on",value:function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];return n.push(t),function(){n.splice(n.indexOf(t),1)}}},{key:"off",value:function(e,t){var n=this._events[e];return n&&n.splice(n.indexOf(t),1),this}},{key:"trigger",value:function(e,t){var n=this._events[e];if(n)for(var i=0,r=n.length;r>i;i++)n[i](t);return this}}]),e}();n.CallbackStore=o},{}],43:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e),this._keyToValue={},this._values=[],this._keys=[],this._keyToIndex={},this._freedIndices=[]}return r(e,[{key:"register",value:function(e,t){var n=this._keyToIndex[e];null==n?(n=this._freedIndices.pop(),void 0===n&&(n=this._values.length),this._values[n]=t,this._keys[n]=e,this._keyToIndex[e]=n,this._keyToValue[e]=t):(this._keyToValue[e]=t,this._values[n]=t)}},{key:"unregister",value:function(e){var t=this._keyToIndex[e];null!=t&&(this._freedIndices.push(t),this._keyToValue[e]=null,this._keyToIndex[e]=null,this._values[t]=null,this._keys[t]=null)}},{key:"get",value:function(e){return this._keyToValue[e]}},{key:"getValues",value:function(){return this._values}},{key:"getKeys",value:function(){return this._keys}},{key:"getKeyToValue",value:function(){return this._keyToValue}}]),e}();n.Registry=o},{}],44:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function r(e){var t;if("object"==typeof e){t=e instanceof Array?[]:{};for(var n in e)if("object"==typeof e[n]&&null!==e[n])if(e[n]instanceof Array){t[n]=new Array(e[n].length);for(var i=0;i<e[n].length;i++)t[n][i]=r(e[n][i])}else t[n]=r(e[n]);else t[n]=e[n]}else t=e;return t};n.clone=i},{}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){var t=[],n=[],i=0;for(var r in e)e.hasOwnProperty(r)&&(t[i]=r,n[i]=e[r],i++);return{keys:t,values:n}};n.keyValueToArrays=i},{}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=["","-ms-","-webkit-","-moz-","-o-"],r=function(e){for(var t=0;t<i.length;t++){var n=i[t]+e;if(""===document.documentElement.style[n])return n}return e};n.vendorPrefix=r},{}],47:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n,r){i(this,e),this.buffer=null,this.target=t,this.type=n,this.data=[],this.gl=r}return r(e,[{key:"subData",value:function(){var e=this.gl;this.buffer=this.buffer||e.createBuffer(),e.bindBuffer(this.target,this.buffer),e.bufferData(this.target,new this.type(this.data),e.STATIC_DRAW)}}]),e}();n.Buffer=o},{}],48:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./Buffer"),s="indices",a=function(){function e(t){i(this,e),this.gl=t,this.registry={},this._dynamicBuffers=[],this._staticBuffers=[],this._arrayBufferMax=3e4,this._elementBufferMax=3e4}return r(e,[{key:"allocate",value:function(e,t,n,i,r){var a,u,h,l,c=this.registry[e]||(this.registry[e]={keys:[],values:[],spacing:[],offset:[],length:[]}),f=c.keys.indexOf(t),d=t===s,p=!1,m=0;if(-1===f){if(f=c.keys.length,u=d?n.length:Math.floor(n.length/i),r)h=new o.Buffer(d?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,d?Uint16Array:Float32Array,this.gl),this._dynamicBuffers.push({buffer:h,offset:n.length,isIndex:d});else{for(l=0;l<this._staticBuffers.length;l++)if(d===this._staticBuffers[l].isIndex&&(a=this._staticBuffers[l].offset+n.length,!d&&a<this._arrayBufferMax||d&&a<this._elementBufferMax)){h=this._staticBuffers[l].buffer,m=this._staticBuffers[l].offset,this._staticBuffers[l].offset+=n.length,p=!0;break}p||(h=new o.Buffer(d?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,d?Uint16Array:Float32Array,this.gl),this._staticBuffers.push({buffer:h,offset:n.length,isIndex:d}))}c.keys.push(t),c.values.push(h),c.spacing.push(i),c.offset.push(m),c.length.push(u)}var _=n.length;for(l=0;_>l;l++)c.values[f].data[m+l]=n[l];c.values[f].subData()}}]),e}();n.BufferRegistry=a},{"./Buffer":47}],49:[function(e,t,n){"use strict";function i(){return r(this.gl.compileShader,function(e){if(!this.getShaderParameter(e,this.COMPILE_STATUS)){var t=this.getShaderInfoLog(e),n=this.getShaderSource(e);o(t,n)}})}function r(e,t){return function(){var n=e.apply(this,arguments);return t.apply(this,arguments),n}}function o(e,t){var n="body,html{background:#e3e3e3;font-family:monaco,monospace;font-size:14px;line-height:1.7em}#shaderReport{left:0;top:0;right:0;box-sizing:border-box;position:absolute;z-index:1000;color:#222;padding:15px;white-space:normal;list-style-type:none;margin:50px auto;max-width:1200px}#shaderReport li{background-color:#fff;margin:13px 0;box-shadow:0 1px 2px rgba(0,0,0,.15);padding:20px 30px;border-radius:2px;border-left:20px solid #e01111}span{color:#e01111;text-decoration:underline;font-weight:700}#shaderReport li p{padding:0;margin:0}#shaderReport li:nth-child(even){background-color:#f4f4f4}#shaderReport li p:first-child{margin-bottom:10px;color:#666}",i=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(i),i.textContent=n;var r=document.createElement("ul");r.setAttribute("id","shaderReport"),document.body.appendChild(r);for(var o,s=/ERROR: [\d]+:([\d]+): (.+)/gim,a=t.split("\n");null!=(o=s.exec(e));){o.index===s.lastIndex&&s.lastIndex++;var u=document.createElement("li"),h='<p><span>ERROR</span> "'+o[2]+'" in line '+o[1]+"</p>";h+="<p><b>"+a[o[1]-1].replace(/^[ \t]+/g,"")+"</b></p>",u.innerHTML=h,r.appendChild(u)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Debug=i},{}],50:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("../utilities/clone"),s=e("../utilities/keyValueToArrays"),a=e("../webgl-shaders"),u=e("./Debug"),h=a.webglShaders.vertex,l=a.webglShaders.fragment,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f="precision mediump float;\n",d={undefined:"float ",1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 ",16:"mat4 "},p={u_baseColor:"vec4",u_normals:"vert",u_glossiness:"vec4",u_positionOffset:"vert"},m={vert:1,vec3:2,vec4:4,"float":8},_=s.keyValueToArrays({u_perspective:c,u_view:c,u_resolution:[0,0,0],u_transform:c,u_size:[1,1,1],u_time:0,u_opacity:1,u_metalness:0,u_glossiness:[0,0,0,0],u_baseColor:[1,1,1,1],u_normals:[1,1,1],u_positionOffset:[0,0,0],u_lightPosition:c,u_lightColor:c,u_ambientLight:[0,0,0],u_flatShading:0,u_numLights:0}),g=s.keyValueToArrays({a_pos:[0,0,0],a_texCoord:[0,0],a_normals:[0,0,0]}),v=s.keyValueToArrays({v_textureCoordinate:[0,0],v_normal:[0,0,0],v_position:[0,0,0],v_eyeVector:[0,0,0]}),y=function(){function e(t,n){i(this,e),this.gl=t,this.options=n||{},this.registeredMaterials={},this.cachedUniforms={},this.uniformTypes=[],this.definitionVec4=[],this.definitionVec3=[],this.definitionFloat=[],this.applicationVec3=[],this.applicationVec4=[],this.applicationFloat=[],this.applicationVert=[],this.definitionVert=[],this.options.debug&&(this.gl.compileShader=u.Debug.call(this)),this.resetProgram()}return r(e,[{key:"registerMaterial",value:function(e,t){var n=t,i=p[e],r=m[i];if((this.registeredMaterials[t._id]&r)===r)return this;var o;for(o in n.uniforms)-1===_.keys.indexOf(o)&&(_.keys.push(o),
_.values.push(n.uniforms[o]));for(o in n.varyings)-1===v.keys.indexOf(o)&&(v.keys.push(o),v.values.push(n.varyings[o]));for(o in n.attributes)-1===g.keys.indexOf(o)&&(g.keys.push(o),g.values.push(n.attributes[o]));switch(this.registeredMaterials[t._id]|=r,i){case"float":this.definitionFloat.push(t.defines),this.definitionFloat.push("float fa_"+t._id+"() {\n "+n.glsl+" \n}"),this.applicationFloat.push("if (int(abs(ID)) == "+t._id+") return fa_"+t._id+"();");break;case"vec3":this.definitionVec3.push(t.defines),this.definitionVec3.push("vec3 fa_"+t._id+"() {\n "+n.glsl+" \n}"),this.applicationVec3.push("if (int(abs(ID.x)) == "+t._id+") return fa_"+t._id+"();");break;case"vec4":this.definitionVec4.push(t.defines),this.definitionVec4.push("vec4 fa_"+t._id+"() {\n "+n.glsl+" \n}"),this.applicationVec4.push("if (int(abs(ID.x)) == "+t._id+") return fa_"+t._id+"();");break;case"vert":this.definitionVert.push(t.defines),this.definitionVert.push("vec3 fa_"+t._id+"() {\n "+n.glsl+" \n}"),this.applicationVert.push("if (int(abs(ID.x)) == "+t._id+") return fa_"+t._id+"();")}return this.resetProgram()}},{key:"resetProgram",value:function(){var e,t,n,i,r,s,a=[f],u=[f];for(this.uniformLocations=[],this.attributeLocations={},this.uniformTypes={},this.attributeNames=o.clone(g.keys),this.attributeValues=o.clone(g.values),this.varyingNames=o.clone(v.keys),this.varyingValues=o.clone(v.values),this.uniformNames=o.clone(_.keys),this.uniformValues=o.clone(_.values),this.cachedUniforms={},u.push("uniform sampler2D u_textures[7];\n"),this.applicationVert.length&&a.push("uniform sampler2D u_textures[7];\n"),s=0;s<this.uniformNames.length;s++)i=this.uniformNames[s],r=this.uniformValues[s],a.push("uniform "+d[r.length]+i+";\n"),u.push("uniform "+d[r.length]+i+";\n");for(s=0;s<this.attributeNames.length;s++)i=this.attributeNames[s],r=this.attributeValues[s],a.push("attribute "+d[r.length]+i+";\n");for(s=0;s<this.varyingNames.length;s++)i=this.varyingNames[s],r=this.varyingValues[s],a.push("varying "+d[r.length]+i+";\n"),u.push("varying "+d[r.length]+i+";\n");t=a.join("")+h.replace("#vert_definitions",this.definitionVert.join("\n")).replace("#vert_applications",this.applicationVert.join("\n")),e=u.join("")+l.replace("#vec3_definitions",this.definitionVec3.join("\n")).replace("#vec3_applications",this.applicationVec3.join("\n")).replace("#vec4_definitions",this.definitionVec4.join("\n")).replace("#vec4_applications",this.applicationVec4.join("\n")).replace("#float_definitions",this.definitionFloat.join("\n")).replace("#float_applications",this.applicationFloat.join("\n")),n=this.gl.createProgram(),this.gl.attachShader(n,this.compileShader(this.gl.createShader(this.gl.VERTEX_SHADER),t)),this.gl.attachShader(n,this.compileShader(this.gl.createShader(this.gl.FRAGMENT_SHADER),e)),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS)?(this.program=n,this.gl.useProgram(this.program)):(console.error("link error: "+this.gl.getProgramInfoLog(n)),this.program=null),this.setUniforms(this.uniformNames,this.uniformValues);var c=this.gl.getUniformLocation(this.program,"u_textures[0]");return this.gl.uniform1iv(c,[0,1,2,3,4,5,6]),this}},{key:"uniformIsCached",value:function(e,t){if(null==this.cachedUniforms[e])return t.length?this.cachedUniforms[e]=new Float32Array(t):this.cachedUniforms[e]=t,!1;if(t.length){for(var n=t.length;n--;)if(t[n]!==this.cachedUniforms[e][n]){for(n=t.length;n--;)this.cachedUniforms[e][n]=t[n];return!1}}else if(this.cachedUniforms[e]!==t)return this.cachedUniforms[e]=t,!1;return!0}},{key:"setUniforms",value:function(e,t){var n,i,r,o,s,a=this.gl;if(!this.program)return this;for(o=e.length,s=0;o>s;s++)if(r=e[s],i=t[s],n=this.uniformLocations[r],null!==n&&(void 0===n&&(n=a.getUniformLocation(this.program,r),this.uniformLocations[r]=n),!this.uniformIsCached(r,i)))switch(this.uniformTypes[r]||(this.uniformTypes[r]=this.getUniformTypeFromValue(i)),this.uniformTypes[r]){case"uniform4fv":a.uniform4fv(n,i);break;case"uniform3fv":a.uniform3fv(n,i);break;case"uniform2fv":a.uniform2fv(n,i);break;case"uniform1fv":a.uniform1fv(n,i);break;case"uniform1f":a.uniform1f(n,i);break;case"uniformMatrix3fv":a.uniformMatrix3fv(n,!1,i);break;case"uniformMatrix4fv":a.uniformMatrix4fv(n,!1,i)}return this}},{key:"getUniformTypeFromValue",value:function(e){if(Array.isArray(e)||e instanceof Float32Array)switch(e.length){case 1:return"uniform1fv";case 2:return"uniform2fv";case 3:return"uniform3fv";case 4:return"uniform4fv";case 9:return"uniformMatrix3fv";case 16:return"uniformMatrix4fv"}else if(!isNaN(parseFloat(e))&&isFinite(e))return"uniform1f";throw'cant load uniform "'+name+'" with value:'+JSON.stringify(e)}},{key:"compileShader",value:function(e,t){var n=1;return this.gl.shaderSource(e,t),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)||(console.error("compile error: "+this.gl.getShaderInfoLog(e)),console.error("1: "+t.replace(/\n/g,function(){return"\n"+(n+=1)+": "}))),e}}]),e}();n.Program=y},{"../utilities/clone":44,"../utilities/keyValueToArrays":45,"../webgl-shaders":57,"./Debug":49}],51:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n){i(this,e),n=n||{},this.id=t.createTexture(),this.width=n.width||0,this.height=n.height||0,this.mipmap=n.mipmap,this.format=n.format||"RGBA",this.type=n.type||"UNSIGNED_BYTE",this.gl=t,this.bind(),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,n.flipYWebgl||!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlphaWebgl||!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[n.magFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[n.minFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[n.wrapS]||t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[n.wrapT]||t.CLAMP_TO_EDGE)}return r(e,[{key:"bind",value:function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,this.id),this}},{key:"unbind",value:function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,null),this}},{key:"setImage",value:function(e){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.gl[this.format],this.gl[this.type],e),this.mipmap&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this}},{key:"setArray",value:function(e){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.width,this.height,0,this.gl[this.format],this.gl[this.type],e),this}},{key:"readBack",value:function(e,t,n,i){var r,o=this.gl;e=e||0,t=t||0,n=n||this.width,i=i||this.height;var s=o.createFramebuffer();return o.bindFramebuffer(o.FRAMEBUFFER,s),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.id,0),o.checkFramebufferStatus(o.FRAMEBUFFER)===o.FRAMEBUFFER_COMPLETE&&(r=new Uint8Array(n*i*4),o.readPixels(e,t,n,i,o.RGBA,o.UNSIGNED_BYTE,r)),r}}]),e}();n.Texture=o},{}],52:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){var n=("string"==typeof e?new Image:e)||{};return n.crossOrigin="anonymous",n.src||(n.src=e),n.complete?t(n):n.onload=function(){t(n)},n}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=e("./Texture"),a=e("./createCheckerBoard"),u=function(){function e(t){i(this,e),this.registry=[],this._needsResample=[],this._activeTexture=0,this._boundTexture=null,this._checkerboard=a.createCheckerBoard(),this.gl=t}return o(e,[{key:"update",value:function(e){for(var t=this.registry.length,n=1;t>n;n++){var i=this.registry[n];i&&i.isLoaded&&i.resampleRate&&(!i.lastResample||e-i.lastResample>i.resampleRate)&&(this._needsResample[i.id]||(this._needsResample[i.id]=!0,i.lastResample=e))}}},{key:"register",value:function(e,t){var n,i=this,o=e.data,a=e.id,u=e.options||{},h=this.registry[a];return h||(h=new s.Texture(this.gl,u),h.setImage(this._checkerboard),n=this.registry[a]={resampleRate:u.resampleRate||null,lastResample:null,isLoaded:!1,texture:h,source:o,id:a,slot:t},Array.isArray(o)||o instanceof Uint8Array||o instanceof Float32Array?(this.bindTexture(a),h.setArray(o),n.isLoaded=!0):o instanceof HTMLVideoElement?o.addEventListener("loadeddata",function(){i.bindTexture(a),h.setImage(o),n.isLoaded=!0,n.source=o}):"string"==typeof o&&r(o,function(e){i.bindTexture(a),h.setImage(e),n.isLoaded=!0,n.source=e})),a}},{key:"bindTexture",value:function(e){var t=this.registry[e];this._activeTexture!==t.slot&&(this.gl.activeTexture(this.gl.TEXTURE0+t.slot),this._activeTexture=t.slot),this._boundTexture!==e&&(this._boundTexture=e,t.texture.bind()),this._needsResample[t.id]&&(t.texture.setImage(t.source),this._needsResample[t.id]=!1)}}]),e}();n.TextureManager=u},{"./Texture":51,"./createCheckerBoard":55}],53:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./Program"),s=e("./BufferRegistry"),a=e("./radixSort"),u=e("../utilities/keyValueToArrays"),h=e("./TextureManager"),l=e("./compileMaterial"),c=e("../utilities/Registry"),f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d=u.keyValueToArrays({u_numLights:0,u_ambientLight:new Array(3),u_lightPosition:new Array(3),u_lightColor:new Array(3),u_perspective:new Array(16),u_time:0,u_view:new Array(16)}),p=function(){function e(t,n){i(this,e),t.classList.add("famous-webgl-renderer"),this.canvas=t,this.compositor=n;var r=this.getWebGLContext(this.canvas);r.clearColor(0,0,0,0),r.polygonOffset(.1,.1),r.enable(r.POLYGON_OFFSET_FILL),r.enable(r.DEPTH_TEST),r.enable(r.BLEND),r.depthFunc(r.LEQUAL),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.CULL_FACE),r.cullFace(r.BACK),this.meshRegistry={},this.meshRegistryKeys=[],this.cutoutRegistry=new c.Registry,this.lightRegistry=new c.Registry,this.numLights=0,this.ambientLightColor=[0,0,0],this.lightPositions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lightColors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.textureManager=new h.TextureManager(r),this.bufferRegistry=new s.BufferRegistry(r),this.program=new o.Program(r,{debug:!0}),this.state={boundArrayBuffer:null,boundElementBuffer:null,lastDrawn:null,enabledAttributes:{},enabledAttributesKeys:[]},this.resolutionName=["u_resolution"],this.resolutionValues=[[0,0,0]],this.cachedSize=[],this.projectionTransform=[1,0,0,0,0,1,0,0,0,0,-1e-6,0,-1,1,0,1];var a=this.cutoutGeometry={spec:{id:-1,bufferValues:[[-1,-1,0,1,-1,0,-1,1,0,1,1,0]],bufferNames:["a_pos"],type:"TRIANGLE_STRIP"}};this.bufferRegistry.allocate(this.cutoutGeometry.spec.id,a.spec.bufferNames[0],a.spec.bufferValues[0],3)}return r(e,[{key:"getWebGLContext",value:function(e){if(this.gl)return this.gl;for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=0,i=t.length;i>n&&!this.gl;n++)this.gl=e.getContext(t[n]);if(!this.gl)throw new Error("Could not retrieve WebGL context. Please refer to https://www.khronos.org/webgl/ for requirements");return this.gl}},{key:"createLight",value:function(e){this.numLights++;var t={color:[0,0,0],position:[0,0,0]};return this.lightRegistry.register(e,t),t}},{key:"createMesh",value:function(e){var t=u.keyValueToArrays({u_opacity:1,u_transform:f,u_size:[0,0,0],u_baseColor:[.5,.5,.5,1],u_positionOffset:[0,0,0],u_normals:[0,0,0],u_flatShading:0,u_glossiness:[0,0,0,0]}),n={depth:null,uniformKeys:t.keys,uniformValues:t.values,buffers:{},geometry:null,drawType:null,textures:[],visible:!0};return this.meshRegistry[e]=n,this.meshRegistryKeys.push(e),n}},{key:"setCutoutState",value:function(e,t){var n=this.getOrSetCutout(e);n.visible=t}},{key:"getOrSetCutout",value:function(e){var t=this.cutoutRegistry.get(e);if(!t){var n=u.keyValueToArrays({u_opacity:0,u_transform:f.slice(),u_size:[0,0,0],u_origin:[0,0,0],u_baseColor:[0,0,0,1]});t={uniformKeys:n.keys,uniformValues:n.values,geometry:this.cutoutGeometry.spec.id,drawType:this.cutoutGeometry.spec.type,visible:!0},this.cutoutRegistry.register(e,t)}return t}},{key:"setMeshVisibility",value:function(e,t){var n=this.meshRegistry[e]||this.createMesh(e);n.visible=t}},{key:"removeMesh",value:function(e){delete this.meshRegistry[e];var t=this.meshRegistryKeys.indexOf(e);-1!==t&&this.meshRegistryKeys.splice(t,1)}},{key:"setCutoutUniform",value:function(e,t,n){var i=this.getOrSetCutout(e),r=i.uniformKeys.indexOf(t);if(n.length)for(var o=0,s=n.length;s>o;o++)i.uniformValues[r][o]=n[o];else i.uniformValues[r]=n}},{key:"setMeshOptions",value:function(e,t){var n=this.meshRegistry[e]||this.createMesh(e);return n.options=t,this}},{key:"setAmbientLightColor",value:function(e,t,n,i){return this.ambientLightColor[0]=t,this.ambientLightColor[1]=n,this.ambientLightColor[2]=i,this}},{key:"setLightPosition",value:function(e,t,n,i){var r=this.lightRegistry.get(e)||this.createLight(e);return r.position[0]=t,r.position[1]=n,r.position[2]=i,this}},{key:"setLightColor",value:function(e,t,n,i){var r=this.lightRegistry.get(e)||this.createLight(e);return r.color[0]=t,r.color[1]=n,r.color[2]=i,this}},{key:"handleMaterialInput",value:function(e,t,n){var i=this.meshRegistry[e]||this.createMesh(e);n=l.compileMaterial(n,i.textures.length),i.uniformValues[i.uniformKeys.indexOf(t)][0]=-n._id;for(var r=n.textures.length;r--;)i.textures.push(this.textureManager.register(n.textures[r],i.textures.length+r));return this.program.registerMaterial(t,n),this.updateSize()}},{key:"setGeometry",value:function(e,t,n,i){var r=this.meshRegistry[e]||this.createMesh(e);return r.geometry=t,r.drawType=n,r.dynamic=i,this}},{key:"setMeshUniform",value:function(e,t,n){var i=this.meshRegistry[e]||this.createMesh(e),r=i.uniformKeys.indexOf(t);-1===r?(i.uniformKeys.push(t),i.uniformValues.push(n)):i.uniformValues[r]=n}},{key:"bufferData",value:function(e,t,n,i,r){this.bufferRegistry.allocate(e,t,n,i,r)}},{key:"draw",value:function(e){var t=this.compositor.getTime();this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.textureManager.update(t),this.meshRegistryKeys=a.radixSort(this.meshRegistryKeys,this.meshRegistry),this.setGlobalUniforms(e),this.drawCutouts(),this.drawMeshes()}},{key:"drawMeshes",value:function(){for(var e,t,n=this.gl,i=this.meshRegistryKeys,r=0;r<i.length;r++)if(t=this.meshRegistry[i[r]],t&&(e=this.bufferRegistry.registry[t.geometry],t.visible&&(t.uniformValues[0]<1?(n.depthMask(!1),n.enable(n.BLEND)):(n.depthMask(!0),n.disable(n.BLEND)),e))){for(var o=t.textures.length;o--;)this.textureManager.bindTexture(t.textures[o]);t.options&&this.handleOptions(t.options,t),this.program.setUniforms(t.uniformKeys,t.uniformValues),this.drawBuffers(e,t.drawType,t.geometry),t.options&&this.resetOptions(t.options)}}},{key:"drawCutouts",value:function(){var e,t,n=this.cutoutRegistry.getValues(),i=n.length;this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!0);for(var r=0;i>r;r++)e=n[r],e&&(t=this.bufferRegistry.registry[e.geometry],e.visible&&(this.program.setUniforms(e.uniformKeys,e.uniformValues),this.drawBuffers(t,e.drawType,e.geometry)));this.gl.enable(this.gl.CULL_FACE)}},{key:"setGlobalUniforms",value:function(e){for(var t,n,i=this.lightRegistry.getValues(),r=i.length,o=0;r>o;o++)t=i[o],t&&(n=4*o,this.lightPositions[0+n]=t.position[0],this.lightPositions[1+n]=t.position[1],this.lightPositions[2+n]=t.position[2],this.lightColors[0+n]=t.color[0],this.lightColors[1+n]=t.color[1],this.lightColors[2+n]=t.color[2]);d.values[0]=this.numLights,d.values[1]=this.ambientLightColor,d.values[2]=this.lightPositions,d.values[3]=this.lightColors,this.projectionTransform[0]=1/(.5*this.cachedSize[0]),this.projectionTransform[5]=-1/(.5*this.cachedSize[1]),this.projectionTransform[11]=e.perspectiveTransform[11],d.values[4]=this.projectionTransform,d.values[5]=.001*this.compositor.getTime(),d.values[6]=e.viewTransform,this.program.setUniforms(d.keys,d.values)}},{key:"drawBuffers",value:function(e,t,n){var i,r,o,s,a,u,h,l,c=this.gl,f=0;for(u=e.keys.length,l=0;u>l;l++)i=e.keys[l],"indices"!==i?(r=this.program.attributeLocations[i],-1!==r&&(void 0!==r||(r=c.getAttribLocation(this.program.program,i),this.program.attributeLocations[i]=r,-1!==r))&&(this.state.enabledAttributes[i]||(c.enableVertexAttribArray(r),this.state.enabledAttributes[i]=!0,this.state.enabledAttributesKeys.push(i)),a=e.values[l],o=e.spacing[l],s=e.offset[l],f=e.length[l],this.state.boundArrayBuffer!==a&&(c.bindBuffer(a.target,a.buffer),this.state.boundArrayBuffer=a),this.state.lastDrawn!==n&&c.vertexAttribPointer(r,o,c.FLOAT,c.FALSE,0,4*s))):h=l;var d=this.state.enabledAttributesKeys.length;for(l=0;d>l;l++){var p=this.state.enabledAttributesKeys[l];this.state.enabledAttributes[p]&&-1===e.keys.indexOf(p)&&(c.disableVertexAttribArray(this.program.attributeLocations[p]),this.state.enabledAttributes[p]=!1)}f&&(void 0!==h?(a=e.values[h],s=e.offset[h],o=e.spacing[h],f=e.length[h],this.state.boundElementBuffer!==a&&(c.bindBuffer(a.target,a.buffer),this.state.boundElementBuffer=a),c.drawElements(c[t],f,c.UNSIGNED_SHORT,2*s)):c.drawArrays(c[t],0,f)),this.state.lastDrawn=n}},{key:"updateSize",value:function(e){if(e){var t=window.devicePixelRatio||1,n=~~(e[0]*t),i=~~(e[1]*t);this.canvas.width=n,this.canvas.height=i,this.gl.viewport(0,0,n,i),this.cachedSize[0]=e[0],this.cachedSize[1]=e[1],this.cachedSize[2]=e[0]>e[1]?e[0]:e[1],this.resolutionValues[0]=this.cachedSize}return this.program.setUniforms(this.resolutionName,this.resolutionValues),this}},{key:"handleOptions",value:function(e,t){var n=this.gl;if(e)switch(e.blending&&n.enable(n.BLEND),e.side){case"double":this.gl.cullFace(this.gl.FRONT),this.drawBuffers(this.bufferRegistry.registry[t.geometry],t.drawType,t.geometry),this.gl.cullFace(this.gl.BACK);break;case"back":n.cullFace(n.FRONT)}}},{key:"resetOptions",value:function(e){var t=this.gl;e&&(e.blending&&t.disable(t.BLEND),"back"===e.side&&t.cullFace(t.BACK))}}]),e}();n.WebGLRenderer=p},{"../utilities/Registry":43,"../utilities/keyValueToArrays":45,"./BufferRegistry":48,"./Program":50,"./TextureManager":52,"./compileMaterial":54,"./radixSort":56}],54:[function(e,t,n){"use strict";function i(e,t){var n="",i={},u={},l={},c=[],f=[];return e.traverse(function(e,d){if(e.chunk){var p=h[r(e)],m=s(e),_=o(e.chunk.glsl,e.inputs,f.length+t);n+=p+m+" = "+_+"\n ",e.uniforms&&a(i,e.uniforms),e.varyings&&a(u,e.varyings),e.attributes&&a(l,e.attributes),e.chunk.defines&&c.push(e.chunk.defines),e.texture&&f.push(e.texture)}}),{_id:e._id,glsl:n+"return "+s(e)+";",defines:c.join("\n"),uniforms:i,varyings:u,attributes:l,textures:f}}function r(e){if("number"==typeof e)return 1;if(Array.isArray(e))return e.length;var t=e.chunk.output;if("number"==typeof t)return t;var n=e.inputs.map(function(e){return r(e)}).join(",");return t[n]}function o(e,t,n){return e.replace(/%\d/g,function(e){return s(t[e[1]-1])}).replace(/\$TEXTURE/,"u_textures["+n+"]")}function s(e){return Array.isArray(e)?u(e):"object"==typeof e?"fa_"+e._id:e.toFixed(6)}function a(e,t){for(var n in t)e[n]=t[n]}function u(e){var t=e.length;return"vec"+t+"("+e.join(",")+")"}Object.defineProperty(n,"__esModule",{value:!0});var h={1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 "};n.compileMaterial=i},{}],55:[function(e,t,n){"use strict";function i(){var e=document.createElement("canvas").getContext("2d");e.canvas.width=e.canvas.height=128;for(var t=0;t<e.canvas.height;t+=16)for(var n=0;n<e.canvas.width;n+=16)e.fillStyle=16&(n^t)?"#FFF":"#DDD",e.fillRect(n,t,16,16);return e.canvas}Object.defineProperty(n,"__esModule",{value:!0}),n.createCheckerBoard=i},{}],56:[function(e,t,n){"use strict";function i(e,t,n){var i=e[n],r=t[i];return(r.depth?r.depth:t[i].uniformValues[1][14])+g}function r(e,t,n,i){var r=e[n];return t[r].depth=a(i)-g,r}function o(e,t,n){t[e[n]].depth=null}function s(e){return y[0]=e,b[0]}function a(e){return b[0]=e,y[0]}function u(e,t){var n,a,u,d,g,v,y,b,E,T,O,C=0,S=[];for(m=32/h+.999999999999999|0,n=0,d=l*m;d>n;n++)f[n]=0;for(n=0,d=e.length;d>n;n++){for(g=s(i(e,t,n)),g^=g>>31|2147483648,a=0,u=0;_>a;a+=l,u+=h)f[a+(g>>>u&c)]++;f[a+(g>>>u&p)]++}for(a=0;_>=a;a+=l)for(b=a,E=0;a+l>b;b++)T=f[b]+E,f[b]=E-1,E=T;if(--m){for(n=0,d=e.length;d>n;n++)g=s(i(e,t,n)),S[++f[g&c]]=r(e,t,n,g^=g>>31|2147483648);for(y=S,S=e,e=y;++C<m;){for(n=0,d=e.length,v=C*l,O=C*h;d>n;n++)g=s(i(e,t,n)),S[++f[v+(g>>>O&c)]]=e[n];y=S,S=e,e=y}}for(n=0,d=e.length,v=C*l,O=C*h;d>n;n++)g=s(i(e,t,n)),S[++f[v+(g>>>O&p)]]=r(e,t,n,g^(~g>>31|2147483648)),o(e,t,n);return S}Object.defineProperty(n,"__esModule",{value:!0});var h=11,l=1<<h,c=l-1,f=new Array(l*Math.ceil(64/h)),d=1<<31%h,p=(d<<1)-1,m=32/h+.999999999999999|0,_=l*(m-1),g=Math.pow(20,6),v=new ArrayBuffer(4),y=new Float32Array(v,0,1),b=new Int32Array(v,0,1);n.radixSort=u},{}],57:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={vertex:'#define GLSLIFY 1\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * Calculates transpose inverse matrix from transform\r\n * \r\n * @method random\r\n * @private\r\n *\r\n *\r\n */\r\n\r\n\r\nmat3 getNormalMatrix_1_0(in mat4 t) {\r\n   mat3 matNorm;\r\n   mat4 a = t;\r\n\r\n   float a00 = a[0][0], a01 = a[0][1], a02 = a[0][2], a03 = a[0][3],\r\n   a10 = a[1][0], a11 = a[1][1], a12 = a[1][2], a13 = a[1][3],\r\n   a20 = a[2][0], a21 = a[2][1], a22 = a[2][2], a23 = a[2][3],\r\n   a30 = a[3][0], a31 = a[3][1], a32 = a[3][2], a33 = a[3][3],\r\n   b00 = a00 * a11 - a01 * a10,\r\n   b01 = a00 * a12 - a02 * a10,\r\n   b02 = a00 * a13 - a03 * a10,\r\n   b03 = a01 * a12 - a02 * a11,\r\n   b04 = a01 * a13 - a03 * a11,\r\n   b05 = a02 * a13 - a03 * a12,\r\n   b06 = a20 * a31 - a21 * a30,\r\n   b07 = a20 * a32 - a22 * a30,\r\n   b08 = a20 * a33 - a23 * a30,\r\n   b09 = a21 * a32 - a22 * a31,\r\n   b10 = a21 * a33 - a23 * a31,\r\n   b11 = a22 * a33 - a23 * a32,\r\n\r\n   det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n   det = 1.0 / det;\r\n\r\n   matNorm[0][0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n   matNorm[0][1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n   matNorm[0][2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\r\n   matNorm[1][0] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n   matNorm[1][1] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n   matNorm[1][2] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\r\n   matNorm[2][0] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n   matNorm[2][1] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n   matNorm[2][2] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\r\n   return matNorm;\r\n}\r\n\r\n\n\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * Calculates a matrix that creates the identity when multiplied by m\r\n * \r\n * @method inverse\r\n * @private\r\n *\r\n *\r\n */\r\n\r\n\r\nfloat inverse_2_1(float m) {\r\n    return 1.0 / m;\r\n}\r\n\r\nmat2 inverse_2_1(mat2 m) {\r\n    return mat2(m[1][1],-m[0][1],\r\n               -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\r\n}\r\n\r\nmat3 inverse_2_1(mat3 m) {\r\n    float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\r\n    float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\r\n    float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\r\n\r\n    float b01 =  a22 * a11 - a12 * a21;\r\n    float b11 = -a22 * a10 + a12 * a20;\r\n    float b21 =  a21 * a10 - a11 * a20;\r\n\r\n    float det = a00 * b01 + a01 * b11 + a02 * b21;\r\n\r\n    return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\r\n                b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\r\n                b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\r\n}\r\n\r\nmat4 inverse_2_1(mat4 m) {\r\n    float\r\n        a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\r\n        a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\r\n        a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\r\n        a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\r\n\r\n        b00 = a00 * a11 - a01 * a10,\r\n        b01 = a00 * a12 - a02 * a10,\r\n        b02 = a00 * a13 - a03 * a10,\r\n        b03 = a01 * a12 - a02 * a11,\r\n        b04 = a01 * a13 - a03 * a11,\r\n        b05 = a02 * a13 - a03 * a12,\r\n        b06 = a20 * a31 - a21 * a30,\r\n        b07 = a20 * a32 - a22 * a30,\r\n        b08 = a20 * a33 - a23 * a30,\r\n        b09 = a21 * a32 - a22 * a31,\r\n        b10 = a21 * a33 - a23 * a31,\r\n        b11 = a22 * a33 - a23 * a32,\r\n\r\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n    return mat4(\r\n        a11 * b11 - a12 * b10 + a13 * b09,\r\n        a02 * b10 - a01 * b11 - a03 * b09,\r\n        a31 * b05 - a32 * b04 + a33 * b03,\r\n        a22 * b04 - a21 * b05 - a23 * b03,\r\n        a12 * b08 - a10 * b11 - a13 * b07,\r\n        a00 * b11 - a02 * b08 + a03 * b07,\r\n        a32 * b02 - a30 * b05 - a33 * b01,\r\n        a20 * b05 - a22 * b02 + a23 * b01,\r\n        a10 * b10 - a11 * b08 + a13 * b06,\r\n        a01 * b08 - a00 * b10 - a03 * b06,\r\n        a30 * b04 - a31 * b02 + a33 * b00,\r\n        a21 * b02 - a20 * b04 - a23 * b00,\r\n        a11 * b07 - a10 * b09 - a12 * b06,\r\n        a00 * b09 - a01 * b07 + a02 * b06,\r\n        a31 * b01 - a30 * b03 - a32 * b00,\r\n        a20 * b03 - a21 * b01 + a22 * b00) / det;\r\n}\r\n\r\n\n\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * Reflects a matrix over its main diagonal.\r\n * \r\n * @method transpose\r\n * @private\r\n *\r\n *\r\n */\r\n\r\n\r\nfloat transpose_3_2(float m) {\r\n    return m;\r\n}\r\n\r\nmat2 transpose_3_2(mat2 m) {\r\n    return mat2(m[0][0], m[1][0],\r\n                m[0][1], m[1][1]);\r\n}\r\n\r\nmat3 transpose_3_2(mat3 m) {\r\n    return mat3(m[0][0], m[1][0], m[2][0],\r\n                m[0][1], m[1][1], m[2][1],\r\n                m[0][2], m[1][2], m[2][2]);\r\n}\r\n\r\nmat4 transpose_3_2(mat4 m) {\r\n    return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\r\n                m[0][1], m[1][1], m[2][1], m[3][1],\r\n                m[0][2], m[1][2], m[2][2], m[3][2],\r\n                m[0][3], m[1][3], m[2][3], m[3][3]);\r\n}\r\n\r\n\n\n\r\n/**\r\n * Converts vertex from modelspace to screenspace using transform\r\n * information from context.\r\n *\r\n * @method applyTransform\r\n * @private\r\n *\r\n *\r\n */\r\n\r\nvec4 applyTransform(vec4 pos) {\r\n    //TODO: move this multiplication to application code. \r\n\r\n    /**\r\n     * Currently multiplied in the vertex shader to avoid consuming the complexity of holding an additional\r\n     * transform as state on the mesh object in WebGLRenderer. Multiplies the object\'s transformation from object space\r\n     * to world space with its transformation from world space to eye space.\r\n     */\r\n    mat4 MVMatrix = u_view * u_transform;\r\n\r\n    //TODO: move the origin, sizeScale and y axis inversion to application code in order to amortize redundant per-vertex calculations.\r\n\r\n    /**\r\n     * The transform uniform should be changed to the result of the transformation chain:\r\n     *\r\n     * view * modelTransform * invertYAxis * sizeScale * origin\r\n     *\r\n     * which could be simplified to:\r\n     *\r\n     * view * modelTransform * convertToDOMSpace\r\n     *\r\n     * where convertToDOMSpace represents the transform matrix:\r\n     *\r\n     *                           size.x 0       0       size.x \r\n     *                           0      -size.y 0       size.y\r\n     *                           0      0       1       0\r\n     *                           0      0       0       1\r\n     *\r\n     */\r\n\r\n    /**\r\n     * Assuming a unit volume, moves the object space origin [0, 0, 0] to the "top left" [1, -1, 0], the DOM space origin.\r\n     * Later in the transformation chain, the projection transform negates the rigidbody translation.\r\n     * Equivalent to (but much faster than) multiplying a translation matrix "origin"\r\n     *\r\n     *                           1 0 0 1 \r\n     *                           0 1 0 -1\r\n     *                           0 0 1 0\r\n     *                           0 0 0 1\r\n     *\r\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\r\n     */\r\n    pos.x += 1.0;\r\n    pos.y -= 1.0;\r\n\r\n    /**\r\n     * Assuming a unit volume, scales an object to the amount of pixels in the size uniform vector\'s specified dimensions.\r\n     * Later in the transformation chain, the projection transform transforms the point into clip space by scaling\r\n     * by the inverse of the canvas\' resolution.\r\n     * Equivalent to (but much faster than) multiplying a scale matrix "sizeScale"\r\n     *\r\n     *                           size.x 0      0      0 \r\n     *                           0      size.y 0      0\r\n     *                           0      0      size.z 0\r\n     *                           0      0      0      1\r\n     *\r\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\r\n     */\r\n    pos.xyz *= u_size * 0.5;\r\n\r\n    /**\r\n     * Inverts the object space\'s y axis in order to match DOM space conventions. \r\n     * Later in the transformation chain, the projection transform reinverts the y axis to convert to clip space.\r\n     * Equivalent to (but much faster than) multiplying a scale matrix "invertYAxis"\r\n     *\r\n     *                           1 0 0 0 \r\n     *                           0 -1 0 0\r\n     *                           0 0 1 0\r\n     *                           0 0 0 1\r\n     *\r\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\r\n     */\r\n    pos.y *= -1.0;\r\n\r\n    /**\r\n     * Exporting the vertex\'s position as a varying, in DOM space, to be used for lighting calculations. This has to be in DOM space\r\n     * since light position and direction is derived from the scene graph, calculated in DOM space.\r\n     */\r\n\r\n    v_position = (MVMatrix * pos).xyz;\r\n\r\n    /**\r\n    * Exporting the eye vector (a vector from the center of the screen) as a varying, to be used for lighting calculations.\r\n    * In clip space deriving the eye vector is a matter of simply taking the inverse of the position, as the position is a vector\r\n    * from the center of the screen. However, since our points are represented in DOM space,\r\n    * the position is a vector from the top left corner of the screen, so some additional math is needed (specifically, subtracting\r\n    * the position from the center of the screen, i.e. half the resolution of the canvas).\r\n    */\r\n\r\n    v_eyeVector = (u_resolution * 0.5) - v_position;\r\n\r\n    /**\r\n     * Transforming the position (currently represented in dom space) into view space (with our dom space view transform)\r\n     * and then projecting the point into raster both by applying a perspective transformation and converting to clip space\r\n     * (the perspective matrix is a combination of both transformations, therefore it\'s probably more apt to refer to it as a\r\n     * projection transform).\r\n     */\r\n\r\n    pos = u_perspective * MVMatrix * pos;\r\n\r\n    return pos;\r\n}\r\n\r\n/**\r\n * Placeholder for positionOffset chunks to be templated in.\r\n * Used for mesh deformation.\r\n *\r\n * @method calculateOffset\r\n * @private\r\n *\r\n *\r\n */\r\n#vert_definitions\r\nvec3 calculateOffset(vec3 ID) {\r\n    #vert_applications\r\n    return vec3(0.0);\r\n}\r\n\r\n/**\r\n * Writes the position of the vertex onto the screen.\r\n * Passes texture coordinate and normal attributes as varyings\r\n * and passes the position attribute through position pipeline.\r\n *\r\n * @method main\r\n * @private\r\n *\r\n *\r\n */\r\nvoid main() {\r\n    v_textureCoordinate = a_texCoord;\r\n    vec3 invertedNormals = a_normals + (u_normals.x < 0.0 ? calculateOffset(u_normals) * 2.0 - 1.0 : vec3(0.0));\r\n    invertedNormals.y *= -1.0;\r\n    v_normal = transpose_3_2(mat3(inverse_2_1(u_transform))) * invertedNormals;\r\n    vec3 offsetPos = a_pos + calculateOffset(u_positionOffset);\r\n    gl_Position = applyTransform(vec4(offsetPos, 1.0));\r\n}\r\n',
fragment:'#define GLSLIFY 1\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * Placeholder for fragmentShader  chunks to be templated in.\r\n * Used for normal mapping, gloss mapping and colors.\r\n * \r\n * @method applyMaterial\r\n * @private\r\n *\r\n *\r\n */\r\n\r\n#float_definitions\r\nfloat applyMaterial_1_0(float ID) {\r\n    #float_applications\r\n    return 1.;\r\n}\r\n\r\n#vec3_definitions\r\nvec3 applyMaterial_1_0(vec3 ID) {\r\n    #vec3_applications\r\n    return vec3(0);\r\n}\r\n\r\n#vec4_definitions\r\nvec4 applyMaterial_1_0(vec4 ID) {\r\n    #vec4_applications\r\n\r\n    return vec4(0);\r\n}\r\n\r\n\n\n/**\r\n * The MIT License (MIT)\r\n * \r\n * Copyright (c) 2015 Famous Industries Inc.\r\n * \r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the "Software"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * Calculates the intensity of light on a surface.\r\n *\r\n * @method applyLight\r\n * @private\r\n *\r\n */\r\nvec4 applyLight_2_1(in vec4 baseColor, in vec3 normal, in vec4 glossiness, int numLights, vec3 ambientColor, vec3 eyeVector, mat4 lightPosition, mat4 lightColor, vec3 v_position) {\r\n    vec3 diffuse = vec3(0.0);\r\n    bool hasGlossiness = glossiness.a > 0.0;\r\n    bool hasSpecularColor = length(glossiness.rgb) > 0.0;\r\n\r\n    for(int i = 0; i < 4; i++) {\r\n        if (i >= numLights) break;\r\n        vec3 lightDirection = normalize(lightPosition[i].xyz - v_position);\r\n        float lambertian = max(dot(lightDirection, normal), 0.0);\r\n\r\n        if (lambertian > 0.0) {\r\n            diffuse += lightColor[i].rgb * baseColor.rgb * lambertian;\r\n            if (hasGlossiness) {\r\n                vec3 halfVector = normalize(lightDirection + eyeVector);\r\n                float specularWeight = pow(max(dot(halfVector, normal), 0.0), glossiness.a);\r\n                vec3 specularColor = hasSpecularColor ? glossiness.rgb : lightColor[i].rgb;\r\n                diffuse += specularColor * specularWeight * lambertian;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    return vec4(ambientColor + diffuse, baseColor.a);\r\n}\r\n\r\n\n\n\r\n\r\n/**\r\n * Writes the color of the pixel onto the screen\r\n *\r\n * @method main\r\n * @private\r\n *\r\n *\r\n */\r\nvoid main() {\r\n    vec4 material = u_baseColor.r >= 0.0 ? u_baseColor : applyMaterial_1_0(u_baseColor);\r\n\r\n    /**\r\n     * Apply lights only if flat shading is false\r\n     * and at least one light is added to the scene\r\n     */\r\n    bool lightsEnabled = (u_flatShading == 0.0) && (u_numLights > 0.0 || length(u_ambientLight) > 0.0);\r\n\r\n    vec3 normal = normalize(v_normal);\r\n    vec4 glossiness = u_glossiness.x < 0.0 ? applyMaterial_1_0(u_glossiness) : u_glossiness;\r\n\r\n    vec4 color = lightsEnabled ?\r\n    applyLight_2_1(material, normalize(v_normal), glossiness,\r\n               int(u_numLights),\r\n               u_ambientLight * u_baseColor.rgb,\r\n               normalize(v_eyeVector),\r\n               u_lightPosition,\r\n               u_lightColor,   \r\n               v_position)\r\n    : material;\r\n\r\n    gl_FragColor = color;\r\n    gl_FragColor.a *= u_opacity;   \r\n}\r\n'};n.webglShaders=i},{}],58:[function(e,t,n){"use strict";var i=e("infamous-engine/src/core/FamousEngine"),r=e("infamous-engine/src/components/Camera"),o=e("./js/LogoNode"),s=window.innerWidth,a=window.innerHeight,u=i.FamousEngine.createScene(),h=u.addChild();h.setSizeMode("absolute","absolute","absolute").setAbsoluteSize(s,a,a).setAlign(.5,.5,0).setOrigin(0,0,0).setMountPoint(.5,.5,0);var l=new r.Camera(h);l.setDepth(1e3),i.FamousEngine.init();var c=i.FamousEngine.getClock(),f=new o.LogoNode(h);console.log("logonode",f),c.setTimeout(f.start.bind(f),2e3)},{"./js/LogoNode":60,"infamous-engine/src/components/Camera":1,"infamous-engine/src/core/FamousEngine":7}],59:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},s=e("infamous-engine/src/core/Node"),a=e("infamous-engine/src/dom-renderables/DOMElement"),u=function(e){function t(e){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.rootNode=e.addChild(this),new a.DOMElement(this.rootNode,{tagName:"div"}).setProperty("background-color","#4F4F4F").setProperty("border-radius","15px"),this.rootNode.setSizeMode("absolute","absolute","absolute").setAbsoluteSize(30,30,0).setAlign(.5,.2,0).setOrigin(.5,.5,0).setMountPoint(.5,.5,0).setPosition(0,0,20)}return r(t,e),t}(s.Node);n.LogoDot=u},{"infamous-engine/src/core/Node":8,"infamous-engine/src/dom-renderables/DOMElement":18}],60:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},a=e("infamous-engine/src/core/Node"),u=e("infamous-engine/src/dom-renderables/DOMElement"),h=e("./animation/SpinnerAnimation"),l=e("./LogoDot"),c=e("./LogoPeg"),f=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.rootNode=e.addChild(this),new u.DOMElement(this.rootNode,{tagName:"div"}).setProperty("background-color","white").setProperty("border-radius","98px"),this.rootNode.setSizeMode("absolute","absolute","absolute").setAbsoluteSize(200,200,0).setAlign(.5,.5,0).setOrigin(.5,.5,0).setMountPoint(.5,.5,0),this.logoDot=new l.LogoDot(this.rootNode),this.LogoPeg=new c.LogoPeg(this.rootNode),this.dotAnimation=new h.SpinnerAnimation(this.logoDot,{axis:h.SpinnerAnimation.XAXIS,duration:4e3}),this.pegAnimation=new h.SpinnerAnimation(this.LogoPeg,{axis:h.SpinnerAnimation.YAXIS,duration:4e3}),this.animation=new h.SpinnerAnimation(this.rootNode,{axis:h.SpinnerAnimation.ZAXIS,duration:1e4})}return r(t,e),o(t,[{key:"start",value:function(){this.animation.start(),this.pegAnimation.start(),this.dotAnimation.start()}}]),t}(a.Node);n.LogoNode=f},{"./LogoDot":59,"./LogoPeg":61,"./animation/SpinnerAnimation":62,"infamous-engine/src/core/Node":8,"infamous-engine/src/dom-renderables/DOMElement":18}],61:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var i=!0;i;){var r=e,o=t,s=n;a=h=u=void 0,i=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var h=Object.getPrototypeOf(r);if(null===h)return void 0;e=h,t=o,n=s,i=!0}},s=e("infamous-engine/src/core/Node"),a=e("infamous-engine/src/dom-renderables/DOMElement"),u=function(e){function t(e){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.rootNode=e.addChild(this),new a.DOMElement(this.rootNode,{tagName:"div"}).setProperty("background-color","#4F4F4F").setProperty("border-radius","15px 15px 0 15px"),this.rootNode.setSizeMode("absolute","absolute","absolute").setAbsoluteSize(30,120,0).setAlign(.5,.6,0).setOrigin(.5,.5,0).setMountPoint(.5,.5,0).setPosition(0,0,20)}return r(t,e),t}(s.Node);n.LogoPeg=u},{"infamous-engine/src/core/Node":8,"infamous-engine/src/dom-renderables/DOMElement":18}],62:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("infamous-engine/src/transitions/Transitionable"),s=function(){function e(t,n){var r=this;i(this,e),n||(n={}),this.axis=n.axis||this.YAXIS,this.duration=n.duration||1e4,this.node=t,this.id=t.addComponent(this),this.transition=new o.Transitionable;var s=2*Math.PI/this.duration;return this.rotateAngle=function(){r.transition.from(s).set(2*Math.PI,{duration:r.duration},r.rotateAngle)},this.id}return r(e,[{key:"onUpdate",value:function(e){var t=0,n=0,i=0;switch(this.axis){case this.XAXIS:t=this.transition.get();break;case this.ZAXIS:i=this.transition.get();break;default:n=this.transition.get()}this.node.setRotation(t,n,i),this.node.requestUpdateOnNextTick(this.id)}},{key:"start",value:function(){this.node.requestUpdate(this.id),this.rotateAngle()}}]),e}();n.SpinnerAnimation=s,s.XAXIS=0,s.YAXIS=1,s.ZAXIS=2},{"infamous-engine/src/transitions/Transitionable":41}]},{},[58]);